"use strict";(()=>{var e={};e.id=649,e.ids=[649],e.modules={2934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7790:e=>{e.exports=require("assert")},8893:e=>{e.exports=require("buffer")},4770:e=>{e.exports=require("crypto")},7702:e=>{e.exports=require("events")},2615:e=>{e.exports=require("http")},5240:e=>{e.exports=require("https")},6624:e=>{e.exports=require("querystring")},7360:e=>{e.exports=require("url")},1764:e=>{e.exports=require("util")},1568:e=>{e.exports=require("zlib")},8280:(e,t,r)=>{let n;r.r(t),r.d(t,{originalPathname:()=>nm,patchFetch:()=>nh,requestAsyncStorage:()=>nc,routeModule:()=>nd,serverHooks:()=>np,staticGenerationAsyncStorage:()=>nf});var a,o,i,s,u,l,d,c={};r.r(c),r.d(c,{GET:()=>nl,POST:()=>nl});var f=r(3036),p=r(5736),m=r(5262);let h={PARSE_ERROR:-32700,BAD_REQUEST:-32600,INTERNAL_SERVER_ERROR:-32603,NOT_IMPLEMENTED:-32603,BAD_GATEWAY:-32603,SERVICE_UNAVAILABLE:-32603,GATEWAY_TIMEOUT:-32603,UNAUTHORIZED:-32001,PAYMENT_REQUIRED:-32002,FORBIDDEN:-32003,NOT_FOUND:-32004,METHOD_NOT_SUPPORTED:-32005,TIMEOUT:-32008,CONFLICT:-32009,PRECONDITION_FAILED:-32012,PAYLOAD_TOO_LARGE:-32013,UNSUPPORTED_MEDIA_TYPE:-32015,UNPROCESSABLE_CONTENT:-32022,TOO_MANY_REQUESTS:-32029,CLIENT_CLOSED_REQUEST:-32099},g={[-32700]:"PARSE_ERROR",[-32600]:"BAD_REQUEST",[-32603]:"INTERNAL_SERVER_ERROR",[-32001]:"UNAUTHORIZED",[-32002]:"PAYMENT_REQUIRED",[-32003]:"FORBIDDEN",[-32004]:"NOT_FOUND",[-32005]:"METHOD_NOT_SUPPORTED",[-32008]:"TIMEOUT",[-32009]:"CONFLICT",[-32012]:"PRECONDITION_FAILED",[-32013]:"PAYLOAD_TOO_LARGE",[-32015]:"UNSUPPORTED_MEDIA_TYPE",[-32022]:"UNPROCESSABLE_CONTENT",[-32029]:"TOO_MANY_REQUESTS",[-32099]:"CLIENT_CLOSED_REQUEST"};function y(e,...t){let r=Object.assign(Object.create(null),e);for(let e of t)for(let t in e){if(t in r&&r[t]!==e[t])throw Error(`Duplicate key ${t}`);r[t]=e[t]}return r}function v(e){return!!e&&!Array.isArray(e)&&"object"==typeof e}function w(e){return"function"==typeof e}function b(e){return Object.assign(Object.create(null),e)}h.BAD_GATEWAY,h.SERVICE_UNAVAILABLE,h.GATEWAY_TIMEOUT,h.INTERNAL_SERVER_ERROR;let E="function"==typeof Symbol&&!!Symbol.asyncIterator;function T(e){return E&&v(e)&&Symbol.asyncIterator in e}let O=e=>e();function _(e){return e}var S=Object.create,z=Object.defineProperty,x=Object.getOwnPropertyDescriptor,P=Object.getOwnPropertyNames,D=Object.getPrototypeOf,R=Object.prototype.hasOwnProperty,N=(e,t)=>function(){return t||(0,e[P(e)[0]])((t={exports:{}}).exports,t),t.exports},I=(e,t,r,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(var a,o=P(t),i=0,s=o.length;i<s;i++)a=o[i],R.call(e,a)||a===r||z(e,a,{get:(e=>t[e]).bind(null,a),enumerable:!(n=x(t,a))||n.enumerable});return e},A=(e,t,r)=>(r=null!=e?S(D(e)):{},I(!t&&e&&e.__esModule?r:z(r,"default",{value:e,enumerable:!0}),e));let U=()=>{},j=e=>{Object.freeze&&Object.freeze(e)},C=e=>(function e(t,r,n){var a;let o=r.join(".");return null!==(a=n[o])&&void 0!==a||(n[o]=new Proxy(U,{get(a,o){if("string"==typeof o&&"then"!==o)return e(t,[...r,o],n)},apply(e,n,a){let o=r[r.length-1],i={args:a,path:r};return"call"===o?i={args:a.length>=2?[a[1]]:[],path:r.slice(0,-1)}:"apply"===o&&(i={args:a.length>=2?a[1]:[],path:r.slice(0,-1)}),j(i.args),j(i.path),t(i)}})),n[o]})(e,[],Object.create(null)),M={PARSE_ERROR:400,BAD_REQUEST:400,UNAUTHORIZED:401,PAYMENT_REQUIRED:402,FORBIDDEN:403,NOT_FOUND:404,METHOD_NOT_SUPPORTED:405,TIMEOUT:408,CONFLICT:409,PRECONDITION_FAILED:412,PAYLOAD_TOO_LARGE:413,UNSUPPORTED_MEDIA_TYPE:415,UNPROCESSABLE_CONTENT:422,TOO_MANY_REQUESTS:429,CLIENT_CLOSED_REQUEST:499,INTERNAL_SERVER_ERROR:500,NOT_IMPLEMENTED:501,BAD_GATEWAY:502,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504};function k(e){var t;return null!==(t=M[e])&&void 0!==t?t:500}var q=N({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/typeof.js"(e,t){function r(e){return t.exports=r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t.exports.__esModule=!0,t.exports.default=t.exports,r(e)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}}),L=N({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/toPrimitive.js"(e,t){var r=q().default;t.exports=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=r(a))return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},t.exports.__esModule=!0,t.exports.default=t.exports}}),F=N({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/toPropertyKey.js"(e,t){var r=q().default,n=L();t.exports=function(e){var t=n(e,"string");return"symbol"==r(t)?t:t+""},t.exports.__esModule=!0,t.exports.default=t.exports}}),B=N({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/defineProperty.js"(e,t){var r=F();t.exports=function(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},t.exports.__esModule=!0,t.exports.default=t.exports}}),Y=N({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/objectSpread2.js"(e,t){var r=B();function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}t.exports=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach(function(t){r(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e},t.exports.__esModule=!0,t.exports.default=t.exports}}),W=A(Y(),1);function H(e){let{path:t,error:r,config:n}=e,{code:a}=e.error,o={message:r.message,code:h[a],data:{code:a,httpStatus:k(r.code)}};return n.isDev&&"string"==typeof e.error.stack&&(o.data.stack=e.error.stack),"string"==typeof t&&(o.data.path=t),n.errorFormatter((0,W.default)((0,W.default)({},e),{},{shape:o}))}let V=({shape:e})=>e;var G=A(B(),1),Q=class extends Error{};function J(e){if(e instanceof X||e instanceof Error&&"TRPCError"===e.name)return e;let t=new X({code:"INTERNAL_SERVER_ERROR",cause:e});return e instanceof Error&&e.stack&&(t.stack=e.stack),t}var X=class extends Error{constructor(e){var t,r,n;let a=function(e){if(e instanceof Error)return e;let t=typeof e;if("undefined"!==t&&"function"!==t&&null!==e){if("object"!==t)return Error(String(e));if(v(e))return Object.assign(new Q,e)}}(e.cause);super(null!==(t=null!==(r=e.message)&&void 0!==r?r:null==a?void 0:a.message)&&void 0!==t?t:e.code,{cause:a}),(0,G.default)(this,"cause",void 0),(0,G.default)(this,"code",void 0),this.code=e.code,this.name="TRPCError",null!==(n=this.cause)&&void 0!==n||(this.cause=a)}},$=A(Y(),1);let K={input:{serialize:e=>e,deserialize:e=>e},output:{serialize:e=>e,deserialize:e=>e}};function Z(e,t){return"error"in t?(0,$.default)((0,$.default)({},t),{},{error:e.transformer.output.serialize(t.error)}):"data"in t.result?(0,$.default)((0,$.default)({},t),{},{result:(0,$.default)((0,$.default)({},t.result),{},{data:e.transformer.output.serialize(t.result.data)})}):t}function ee(e,t){return Array.isArray(t)?t.map(t=>Z(e,t)):Z(e,t)}var et=A(Y(),1);let er=Symbol("lazy"),en={_ctx:null,_errorShape:null,_meta:null,queries:{},mutations:{},subscriptions:{},errorFormatter:V,transformer:K},ea=["then","call","apply"];function eo(e){return function(t){let r=new Set(Object.keys(t).filter(e=>ea.includes(e)));if(r.size>0)throw Error("Reserved words used in `router({})` call: "+Array.from(r).join(", "));let n=b({}),a=b({}),o=function e(t,r=[]){let o=b({});for(let[i,s]of Object.entries(null!=t?t:{})){if("function"==typeof s&&er in s){a[[...r,i].join(".")]=function t(r){return{ref:r.ref,load:function(e){let t=Symbol(),r=t;return()=>(r===t&&(r=e()),r)}(async()=>{let n=await r.ref(),o=[...r.path,r.key],i=o.join(".");for(let[s,u]of(r.aggregate[r.key]=e(n._def.record,o),delete a[i],Object.entries(n._def.lazy)))a[[...o,s].join(".")]=t({ref:u.ref,path:o,key:s,aggregate:r.aggregate[r.key]})})}}({path:r,ref:s,key:i,aggregate:o});continue}if(v(s)&&v(s._def)&&"router"in s._def){o[i]=e(s._def.record,[...r,i]);continue}if("function"!=typeof s){o[i]=e(s,[...r,i]);continue}let t=[...r,i].join(".");if(n[t])throw Error(`Duplicate key: ${t}`);n[t]=s,o[i]=s}return o}(t),i=(0,et.default)((0,et.default)({_config:e,router:!0,procedures:n,lazy:a},en),{},{record:o});return(0,et.default)((0,et.default)({},o),{},{_def:i,createCaller:es()({_def:i})})}}async function ei(e,t){let{_def:r}=e,n=r.procedures[t];for(;!n;){let e=Object.keys(r.lazy).find(e=>t.startsWith(e));if(!e)return null;let a=r.lazy[e];await a.load(),n=r.procedures[t]}return n}function es(){return function(e){let{_def:t}=e;return function(r,n){return C(async({path:a,args:o})=>{let i;let s=a.join(".");if(1===a.length&&"_def"===a[0])return t;let u=await ei(e,s);try{if(!u)throw new X({code:"NOT_FOUND",message:`No procedure found on path "${a}"`});return i=w(r)?await Promise.resolve(r()):r,await u({path:s,getRawInput:async()=>o[0],ctx:i,type:u._def.type,signal:null==n?void 0:n.signal})}catch(e){var l,d;throw null==n||null===(l=n.onError)||void 0===l||l.call(n,{ctx:i,error:J(e),input:o[0],path:s,type:null!==(d=null==u?void 0:u._def.type)&&void 0!==d?d:"unknown"}),e}})}}}function eu(...e){var t;let r=y({},...e.map(e=>e._def.record));return eo({errorFormatter:e.reduce((e,t)=>{if(t._def._config.errorFormatter&&t._def._config.errorFormatter!==V){if(e!==V&&e!==t._def._config.errorFormatter)throw Error("You seem to have several error formatters");return t._def._config.errorFormatter}return e},V),transformer:e.reduce((e,t)=>{if(t._def._config.transformer&&t._def._config.transformer!==K){if(e!==K&&e!==t._def._config.transformer)throw Error("You seem to have several transformers");return t._def._config.transformer}return e},K),isDev:e.every(e=>e._def._config.isDev),allowOutsideOfServer:e.every(e=>e._def._config.allowOutsideOfServer),isServer:e.every(e=>e._def._config.isServer),$types:null===(t=e[0])||void 0===t?void 0:t._def._config.$types})(r)}let el=Symbol();function ed(e){return"object"==typeof e&&null!==e&&"subscribe"in e}function ec(e,t){let r=(function(e,t){let r=null,n=()=>{null==r||r.unsubscribe(),r=null,t.removeEventListener("abort",n)};return new ReadableStream({start(a){r=e.subscribe({next(e){a.enqueue({ok:!0,value:e})},error(e){a.enqueue({ok:!1,error:e}),a.close()},complete(){a.close()}}),t.aborted?n():t.addEventListener("abort",n,{once:!0})},cancel(){n()}})})(e,t).getReader(),n={async next(){let e=await r.read();if(e.done)return{value:void 0,done:!0};let{value:t}=e;if(!t.ok)throw t.error;return{value:t.value,done:!1}},return:async()=>(await r.cancel(),{value:void 0,done:!0})};return{[Symbol.asyncIterator]:()=>n}}var ef=A(Y(),1);function ep(e){let t=null,r=Symbol.for("@trpc/server/http/memo"),n=r;return{read:async()=>{var a;return n!==r||(null!==(a=t)&&void 0!==a||(t=e().catch(e=>{if(e instanceof X)throw e;throw new X({code:"BAD_REQUEST",message:e instanceof Error?e.message:"Invalid input",cause:e})})),n=await t,t=null),n},result:()=>n!==r?n:void 0}}let em={isMatch(e){var t;return!!(null===(t=e.headers.get("content-type"))||void 0===t?void 0:t.startsWith("application/json"))},async parse(e){var t;let{req:r}=e,n="1"===e.searchParams.get("batch"),a=n?e.path.split(","):[e.path],o=ep(async()=>{let t;if("GET"===r.method){let r=e.searchParams.get("input");r&&(t=JSON.parse(r))}else t=await r.json();if(void 0===t)return{};if(!n)return{0:e.router._def._config.transformer.input.deserialize(t)};if(!v(t))throw new X({code:"BAD_REQUEST",message:'"input" needs to be an object when doing a batch call'});let o={};for(let r of a.keys()){let n=t[r];void 0!==n&&(o[r]=e.router._def._config.transformer.input.deserialize(n))}return o}),i=await Promise.all(a.map(async(t,r)=>{let n=await ei(e.router,t);return{path:t,procedure:n,getRawInput:async()=>{let t=(await o.read())[r];if((null==n?void 0:n._def.type)==="subscription"){var a,i,s;let r=null!==(a=null!==(i=e.headers.get("last-event-id"))&&void 0!==i?i:e.searchParams.get("lastEventId"))&&void 0!==a?a:e.searchParams.get("Last-Event-Id");r&&(v(t)?t=(0,ef.default)((0,ef.default)({},t),{},{lastEventId:r}):null!==(s=t)&&void 0!==s||(t={lastEventId:r}))}return t},result:()=>{var e;return null===(e=o.result())||void 0===e?void 0:e[r]}}})),s=new Set(i.map(e=>{var t;return null===(t=e.procedure)||void 0===t?void 0:t._def.type}).filter(Boolean));if(s.size>1)throw new X({code:"BAD_REQUEST",message:`Cannot mix procedure types in call: ${Array.from(s).join(", ")}`});let u=null!==(t=s.values().next().value)&&void 0!==t?t:"unknown",l=e.searchParams.get("connectionParams");return{isBatchCall:n,accept:r.headers.get("trpc-accept"),calls:i,type:u,connectionParams:null===l?null:function(e){let t;try{t=JSON.parse(e)}catch(e){throw new X({code:"PARSE_ERROR",message:"Not JSON-parsable query params",cause:e})}return function(e){try{if(null===e)return null;if(!v(e))throw Error("Expected object");let t=Object.entries(e).filter(([e,t])=>"string"!=typeof t);if(t.length>0)throw Error(`Expected connectionParams to be string values. Got ${t.map(([e,t])=>`${e}: ${typeof t}`).join(", ")}`);return e}catch(e){throw new X({code:"PARSE_ERROR",message:"Invalid connection params shape",cause:e})}}(t)}(l),signal:r.signal,url:e.url}}},eh=[em,{isMatch(e){var t;return!!(null===(t=e.headers.get("content-type"))||void 0===t?void 0:t.startsWith("multipart/form-data"))},async parse(e){let{req:t}=e;if("POST"!==t.method)throw new X({code:"METHOD_NOT_SUPPORTED",message:"Only POST requests are supported for multipart/form-data requests"});let r=ep(async()=>await t.formData()),n=await ei(e.router,e.path);return{accept:null,calls:[{path:e.path,getRawInput:r.read,result:r.result,procedure:n}],isBatchCall:!1,type:"mutation",connectionParams:null,signal:t.signal,url:e.url}}},{isMatch(e){var t;return!!(null===(t=e.headers.get("content-type"))||void 0===t?void 0:t.startsWith("application/octet-stream"))},async parse(e){let{req:t}=e;if("POST"!==t.method)throw new X({code:"METHOD_NOT_SUPPORTED",message:"Only POST requests are supported for application/octet-stream requests"});let r=ep(async()=>t.body);return{calls:[{path:e.path,getRawInput:r.read,result:r.result,procedure:await ei(e.router,e.path)}],isBatchCall:!1,accept:null,type:"mutation",connectionParams:null,signal:t.signal,url:e.url}}}];async function eg(e){let t=function(e){let t=eh.find(t=>t.isMatch(e));if(t)return t;if(!t&&"GET"===e.method)return em;throw new X({code:"UNSUPPORTED_MEDIA_TYPE",message:e.headers.has("content-type")?`Unsupported content-type "${e.headers.get("content-type")}`:"Missing content-type header"})}(e.req);return await t.parse(e)}function ey(e="AbortError"){throw new DOMException(e,"AbortError")}var ev=A(B(),1);let ew=new WeakMap,eb=()=>{};n=Symbol.toStringTag;var eE=class e{constructor(e){(0,ev.default)(this,"promise",void 0),(0,ev.default)(this,"subscribers",[]),(0,ev.default)(this,"settlement",null),(0,ev.default)(this,n,"Unpromise"),"function"==typeof e?this.promise=new Promise(e):this.promise=e;let t=this.promise.then(e=>{let{subscribers:t}=this;this.subscribers=null,this.settlement={status:"fulfilled",value:e},null==t||t.forEach(({resolve:t})=>{t(e)})});"catch"in t&&t.catch(e=>{let{subscribers:t}=this;this.subscribers=null,this.settlement={status:"rejected",reason:e},null==t||t.forEach(({reject:t})=>{t(e)})})}subscribe(){let e,t;let{settlement:r}=this;if(null===r){let r,n;if(null===this.subscribers)throw Error("Unpromise settled but still has subscribers");let a={promise:new Promise((e,t)=>{r=e,n=t}),resolve:r,reject:n};this.subscribers=[...this.subscribers,a],e=a.promise,t=()=>{null!==this.subscribers&&(this.subscribers=function(e,t){let r=e.indexOf(t);return -1!==r?[...e.slice(0,r),...e.slice(r+1)]:e}(this.subscribers,a))}}else{let{status:n}=r;e="fulfilled"===n?Promise.resolve(r.value):Promise.reject(r.reason),t=eb}return Object.assign(e,{unsubscribe:t})}then(e,t){let r=this.subscribe(),{unsubscribe:n}=r;return Object.assign(r.then(e,t),{unsubscribe:n})}catch(e){let t=this.subscribe(),{unsubscribe:r}=t;return Object.assign(t.catch(e),{unsubscribe:r})}finally(e){let t=this.subscribe(),{unsubscribe:r}=t;return Object.assign(t.finally(e),{unsubscribe:r})}static proxy(t){let r=e.getSubscribablePromise(t);return void 0!==r?r:e.createSubscribablePromise(t)}static createSubscribablePromise(t){let r=new e(t);return ew.set(t,r),ew.set(r,r),r}static getSubscribablePromise(e){return ew.get(e)}static resolve(t){let r="object"==typeof t&&null!==t&&"then"in t&&"function"==typeof t.then?t:Promise.resolve(t);return e.proxy(r).subscribe()}static async any(t){let r=(Array.isArray(t)?t:[...t]).map(e.resolve);try{return await Promise.any(r)}finally{r.forEach(({unsubscribe:e})=>{e()})}}static async race(t){let r=(Array.isArray(t)?t:[...t]).map(e.resolve);try{return await Promise.race(r)}finally{r.forEach(({unsubscribe:e})=>{e()})}}static async raceReferences(e){let t=e.map(eT);try{return await Promise.race(t)}finally{for(let e of t)e.unsubscribe()}}};function eT(e){return eE.proxy(e).then(()=>[e])}function eO(e,t){let r=e[Symbol.asyncDispose];return e[Symbol.asyncDispose]=async()=>{await t(),await (null==r?void 0:r())},e}null!==(o=(a=Symbol).dispose)&&void 0!==o||(a.dispose=Symbol()),null!==(s=(i=Symbol).asyncDispose)&&void 0!==s||(i.asyncDispose=Symbol());let e_=Symbol();function eS(e){let t=null;return function(e,t){let r=e[Symbol.dispose];return e[Symbol.dispose]=()=>{t(),null==r||r()},e}({start(){if(t)throw Error("Timer already started");return new Promise(r=>{t=setTimeout(()=>r(e_),e)})}},()=>{t&&clearTimeout(t)})}var ez=N({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/usingCtx.js"(e,t){t.exports=function(){var e="function"==typeof SuppressedError?SuppressedError:function(e,t){var r=Error();return r.name="SuppressedError",r.error=e,r.suppressed=t,r},t={},r=[];function n(e,t){if(null!=t){if(Object(t)!==t)throw TypeError("using declarations can only be used with objects, functions, null, or undefined.");if(e)var n=t[Symbol.asyncDispose||Symbol.for("Symbol.asyncDispose")];if(void 0===n&&(n=t[Symbol.dispose||Symbol.for("Symbol.dispose")],e))var a=n;if("function"!=typeof n)throw TypeError("Object is not disposable.");a&&(n=function(){try{a.call(t)}catch(e){return Promise.reject(e)}}),r.push({v:t,d:n,a:e})}else e&&r.push({d:t,a:e});return t}return{e:t,u:n.bind(null,!1),a:n.bind(null,!0),d:function(){var n,a=this.e,o=0;function i(){for(;n=r.pop();)try{if(!n.a&&1===o)return o=0,r.push(n),Promise.resolve().then(i);if(n.d){var e=n.d.call(n.v);if(n.a)return o|=2,Promise.resolve(e).then(i,s)}else o|=1}catch(e){return s(e)}if(1===o)return a!==t?Promise.reject(a):Promise.resolve();if(a!==t)throw a}function s(r){return a=a!==t?new e(r,a):r,i()}return i()}}},t.exports.__esModule=!0,t.exports.default=t.exports}}),ex=N({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/OverloadYield.js"(e,t){t.exports=function(e,t){this.v=e,this.k=t},t.exports.__esModule=!0,t.exports.default=t.exports}}),eP=N({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/awaitAsyncGenerator.js"(e,t){var r=ex();t.exports=function(e){return new r(e,0)},t.exports.__esModule=!0,t.exports.default=t.exports}}),eD=N({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/wrapAsyncGenerator.js"(e,t){var r=ex();function n(e){var t,n;function a(t,n){try{var i=e[t](n),s=i.value,u=s instanceof r;Promise.resolve(u?s.v:s).then(function(r){if(u){var n="return"===t?"return":"next";if(!s.k||r.done)return a(n,r);r=e[n](r).value}o(i.done?"return":"normal",r)},function(e){a("throw",e)})}catch(e){o("throw",e)}}function o(e,r){switch(e){case"return":t.resolve({value:r,done:!0});break;case"throw":t.reject(r);break;default:t.resolve({value:r,done:!1})}(t=t.next)?a(t.key,t.arg):n=null}this._invoke=function(e,r){return new Promise(function(o,i){var s={key:e,arg:r,resolve:o,reject:i,next:null};n?n=n.next=s:(t=n=s,a(e,r))})},"function"!=typeof e.return&&(this.return=void 0)}n.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},n.prototype.next=function(e){return this._invoke("next",e)},n.prototype.throw=function(e){return this._invoke("throw",e)},n.prototype.return=function(e){return this._invoke("return",e)},t.exports=function(e){return function(){return new n(e.apply(this,arguments))}},t.exports.__esModule=!0,t.exports.default=t.exports}}),eR=A(ez(),1),eN=A(eP(),1),eI=A(eD(),1);function eA(e){let t=e[Symbol.asyncIterator]();return t[Symbol.asyncDispose]?t:eO(t,async()=>{var e;await (null===(e=t.return)||void 0===e?void 0:e.call(t))})}function eU(){return(eU=(0,eI.default)(function*(e,t){try{let n;var r=(0,eR.default)();let a=r.a(eA(e)),o=r.u(eS(t.maxDurationMs)).start();for(;;){if((n=yield(0,eN.default)(eE.race([a.next(),o])))===e_&&ey(),n.done)return n;yield n.value,n=null}}catch(e){r.e=e}finally{yield(0,eN.default)(r.d())}})).apply(this,arguments)}function ej(){return(ej=(0,eI.default)(function*(e,t){try{let n;var r=(0,eR.default)();let a=r.a(eA(e)),o=r.u(eS(t.gracePeriodMs)),i=t.count,s=new Promise(()=>{});for(;;){if((n=yield(0,eN.default)(eE.race([a.next(),s])))===e_&&ey(),n.done)return n.value;yield n.value,0==--i&&(s=o.start()),n=null}}catch(e){r.e=e}finally{yield(0,eN.default)(r.d())}})).apply(this,arguments)}function eC(){let e,t;return{promise:new Promise((r,n)=>{e=r,t=n}),resolve:e,reject:t}}var eM=A(ez(),1),ek=A(eP(),1),eq=A(eD(),1);function eL(e){let t=e[Symbol.asyncIterator]();return new ReadableStream({async cancel(){var e;await (null===(e=t.return)||void 0===e?void 0:e.call(t))},async pull(e){let r=await t.next();if(r.done){e.close();return}e.enqueue(r.value)}})}var eF=A(ez(),1),eB=A(eP(),1),eY=A(eD(),1);let eW=Symbol("ping");function eH(e,t){return eV.apply(this,arguments)}function eV(){return(eV=(0,eY.default)(function*(e,t){try{let a;var r=(0,eF.default)();let o=r.a(eA(e)),i=o.next();for(;;)try{var n=(0,eF.default)();let e=n.u(eS(t));if((a=yield(0,eB.default)(eE.race([i,e.start()])))===e_){yield eW;continue}if(a.done)return a.value;i=o.next(),yield a.value,a=null}catch(e){n.e=e}finally{n.d()}}catch(e){r.e=e}finally{yield(0,eB.default)(r.d())}})).apply(this,arguments)}var eG=N({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/asyncIterator.js"(e,t){function r(e){function t(e){if(Object(e)!==e)return Promise.reject(TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return(r=function(e){this.s=e,this.n=e.next}).prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var r=this.s.return;return void 0===r?Promise.resolve({value:e,done:!0}):t(r.apply(this.s,arguments))},throw:function(e){var r=this.s.return;return void 0===r?Promise.reject(e):t(r.apply(this.s,arguments))}},new r(e)}t.exports=function(e){var t,n,a,o=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,a=Symbol.iterator);o--;){if(n&&null!=(t=e[n]))return t.call(e);if(a&&null!=(t=e[a]))return new r(t.call(e));n="@@asyncIterator",a="@@iterator"}throw TypeError("Object is not async iterable")},t.exports.__esModule=!0,t.exports.default=t.exports}}),eQ=A(eP(),1),eJ=A(eD(),1),eX=A(ez(),1),e$=A(eG(),1);function eK(e){return(v(e)||w(e))&&"function"==typeof(null==e?void 0:e.then)&&"function"==typeof(null==e?void 0:e.catch)}var eZ=class extends Error{constructor(e){super("Max depth reached at path: "+e.join(".")),this.path=e}};function e0(){return(e0=(0,eJ.default)(function*(e){let{data:t}=e,r=0,n=function(){let e="idle",t=eC(),r=[],n=new Set,a=[];function o(r){if("pending"!==e)return;let o=function(e,t){let r=e[Symbol.asyncIterator](),n="idle";function a(){n="done",t=()=>{}}return{pull:function(){"idle"===n&&(n="pending",r.next().then(e=>{if(e.done){n="done",t({status:"return",value:e.value}),a();return}n="idle",t({status:"yield",value:e.value})}).catch(e=>{t({status:"error",error:e}),a()}))},destroy:async()=>{var e;a(),await (null===(e=r.return)||void 0===e?void 0:e.call(r))}}}(r,r=>{if("pending"===e){switch(r.status){case"yield":a.push([o,r]);break;case"return":n.delete(o);break;case"error":a.push([o,r]),n.delete(o)}t.resolve()}});n.add(o),o.pull()}return{add(t){switch(e){case"idle":r.push(t);break;case"pending":o(t)}},[Symbol.asyncIterator]:()=>(0,eq.default)(function*(){try{var i=(0,eM.default)();if("idle"!==e)throw Error("Cannot iterate twice");for(e="pending",i.a(eO({},async()=>{e="done";let r=[];if(await Promise.all(Array.from(n.values()).map(async e=>{try{await e.destroy()}catch(e){r.push(e)}})),a.length=0,n.clear(),t.resolve(),r.length>0)throw AggregateError(r)}));r.length>0;)o(r.shift());for(;n.size>0;){for(yield(0,ek.default)(t.promise);a.length>0;){let[e,t]=a.shift();switch(t.status){case"yield":yield t.value,e.pull();break;case"error":throw t.error}}t=eC()}}catch(e){i.e=e}finally{yield(0,ek.default)(i.d())}})()}}();function a(e){let t=r++,a=e(t);return n.add(a),t}function o(t){return e.maxDepth&&t.length>e.maxDepth?new eZ(t):null}function i(t,r){var n,i,u;if(eK(t))return[0,(n=t,a((i=(0,eJ.default)(function*(t){let a=o(r);a&&(n.catch(t=>{var n;null===(n=e.onError)||void 0===n||n.call(e,{error:t,path:r})}),n=Promise.reject(a));try{let e=yield(0,eQ.default)(n);yield[t,0,s(e,r)]}catch(n){var i,u;null===(i=e.onError)||void 0===i||i.call(e,{error:n,path:r}),yield[t,1,null===(u=e.formatError)||void 0===u?void 0:u.call(e,{error:n,path:r})]}}),function(e){return i.apply(this,arguments)})))];if(T(t)){if(e.maxDepth&&r.length>=e.maxDepth)throw Error("Max depth reached");return[1,a((u=(0,eJ.default)(function*(n){try{var a,i,u=(0,eX.default)();let l=o(r);if(l)throw l;let d=u.a(eA(t));try{for(;;){let e=yield(0,eQ.default)(d.next());if(e.done){yield[n,0,s(e.value,r)];break}yield[n,1,s(e.value,r)]}}catch(t){null===(a=e.onError)||void 0===a||a.call(e,{error:t,path:r}),yield[n,2,null===(i=e.formatError)||void 0===i?void 0:i.call(e,{error:t,path:r})]}}catch(e){u.e=e}finally{yield(0,eQ.default)(u.d())}}),function(e){return u.apply(this,arguments)}))]}return null}function s(e,t){if(void 0===e)return[[]];let r=i(e,t);if(r)return[[0],[null,...r]];if("[object Object]"!==Object.prototype.toString.call(e))return[[e]];let n={},a=[];for(let[r,o]of Object.entries(e)){let e=i(o,[...t,r]);if(!e){n[r]=o;continue}n[r]=0,a.push([r,...e])}return[[n],...a]}let u={};for(let[e,r]of Object.entries(t))u[e]=s(r,[e]);yield u;let l=n;e.pingMs&&(l=eH(n,e.pingMs));var d=!1,c=!1;try{for(var f,p,m=(0,e$.default)(l);d=!(p=yield(0,eQ.default)(m.next())).done;d=!1){let e=p.value;yield e}}catch(e){c=!0,f=e}finally{try{d&&null!=m.return&&(yield(0,eQ.default)(m.return()))}finally{if(c)throw f}}})).apply(this,arguments)}var e1=N({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/asyncGeneratorDelegate.js"(e,t){var r=ex();t.exports=function(e){var t={},n=!1;function a(t,a){return n=!0,{done:!1,value:new r(a=new Promise(function(r){r(e[t](a))}),1)}}return t["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},t.next=function(e){return n?(n=!1,e):a("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(n)throw n=!1,e;return a("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return n?(n=!1,e):a("return",e)}),t},t.exports.__esModule=!0,t.exports.default=t.exports}}),e2=A(eG(),1),e3=A(eP(),1),e4=A(eD(),1),e6=A(e1(),1);A(ez(),1);let e7={"Content-Type":"text/event-stream","Cache-Control":"no-cache, no-transform","X-Accel-Buffering":"no",Connection:"keep-alive"};var e5=A(eD(),1),e9=A(Y(),1);function e8(e){return O((0,e5.default)(function*(){throw e}))}let te={mutation:["POST"],query:["GET"],subscription:["GET"]},tt={mutation:["POST"],query:["GET","POST"],subscription:["GET","POST"]};function tr(e){var t,r,n;let{ctx:a,info:o,responseMeta:i,untransformedJSON:s,errors:u=[],headers:l}=e,d=s?function(e){let t=new Set((Array.isArray(e)?e:[e]).map(e=>{if("error"in e&&v(e.error.data)){var t;return"number"==typeof(null===(t=e.error.data)||void 0===t?void 0:t.httpStatus)?e.error.data.httpStatus:k(g[e.error.code])}return 200}));return 1!==t.size?207:t.values().next().value}(s):200,c=!s,f=c?[]:Array.isArray(s)?s:[s],p=null!==(t=null==i?void 0:i({ctx:a,info:o,paths:null==o?void 0:o.calls.map(e=>e.path),data:f,errors:u,eagerGeneration:c,type:null!==(r=null==o||null===(n=o.calls.find(e=>{var t;return null===(t=e.procedure)||void 0===t?void 0:t._def.type}))||void 0===n||null===(n=n.procedure)||void 0===n?void 0:n._def.type)&&void 0!==r?r:"unknown"}))&&void 0!==t?t:{};if(p.headers){if(p.headers instanceof Headers)for(let[e,t]of p.headers.entries())l.append(e,t);else for(let[e,t]of Object.entries(p.headers))if(Array.isArray(t))for(let r of t)l.append(e,r);else"string"==typeof t&&l.set(e,t)}return p.status&&(d=p.status),{status:d}}function tn(e){return!!v(e)&&(!!T(e)||Object.values(e).some(eK)||Object.values(e).some(T))}async function ta(e){var t,r,n,a,o,i,s;let{router:u,req:l}=e,d=new Headers([["vary","trpc-accept"]]),c=u._def._config,f=new URL(l.url);if("HEAD"===l.method)return new Response(null,{status:204});let p=null===(t=null!==(r=e.allowBatching)&&void 0!==r?r:null===(n=e.batching)||void 0===n?void 0:n.enabled)||void 0===t||t,m=null!==(a=e.allowMethodOverride)&&void 0!==a&&a&&"POST"===l.method,h=await O(async()=>{try{return[void 0,await eg({req:l,path:decodeURIComponent(e.path),router:u,searchParams:f.searchParams,headers:e.req.headers,url:f})]}catch(e){return[J(e),void 0]}}),g=O(()=>{let t;return{valueOrUndefined:()=>{if(t)return t[1]},value:()=>{let[e,r]=t;if(e)throw e;return r},create:async r=>{if(t)throw Error("This should only be called once - report a bug in tRPC");try{let n=await e.createContext({info:r});t=[void 0,n]}catch(e){t=[J(e),void 0]}}}}),y=m?tt:te,w="application/jsonl"===l.headers.get("trpc-accept"),b=null===(o=null===(i=c.sse)||void 0===i?void 0:i.enabled)||void 0===o||o;try{let[t,r]=h;if(t)throw t;if(r.isBatchCall&&!p)throw new X({code:"BAD_REQUEST",message:"Batching is not enabled on the server"});if(w&&!r.isBatchCall)throw new X({message:"Streaming requests must be batched (you can do a batch of 1)",code:"BAD_REQUEST"});await g.create(r);let n=r.calls.map(async t=>{let n=t.procedure;try{if(e.error)throw e.error;if(!n)throw new X({code:"NOT_FOUND",message:`No procedure found on path "${t.path}"`});if(!y[n._def.type].includes(l.method))throw new X({code:"METHOD_NOT_SUPPORTED",message:`Unsupported ${l.method}-request to ${n._def.type} procedure at path "${t.path}"`});if("subscription"===n._def.type&&r.isBatchCall)throw new X({code:"BAD_REQUEST",message:"Cannot batch subscription calls"});let a=await n({path:t.path,getRawInput:t.getRawInput,ctx:g.value(),type:n._def.type,signal:e.req.signal});return[void 0,{data:a}]}catch(s){var a,o,i;let r=J(s),n=t.result();return null===(a=e.onError)||void 0===a||a.call(e,{error:r,path:t.path,input:n,ctx:g.valueOrUndefined(),type:null!==(o=null===(i=t.procedure)||void 0===i?void 0:i._def.type)&&void 0!==o?o:"unknown",req:e.req}),[r,void 0]}});if(!r.isBatchCall){let[t]=r.calls,[a,o]=await n[0];switch(r.type){case"unknown":case"mutation":case"query":{if(d.set("content-type","application/json"),tn(null==o?void 0:o.data))throw new X({code:"UNSUPPORTED_MEDIA_TYPE",message:"Cannot use stream-like response in non-streaming request - use httpBatchStreamLink"});let n=a?{error:H({config:c,ctx:g.valueOrUndefined(),error:a,input:t.result(),path:t.path,type:r.type})}:{result:{data:o.data}},i=tr({ctx:g.valueOrUndefined(),info:r,responseMeta:e.responseMeta,errors:a?[a]:[],headers:d,untransformedJSON:[n]});return new Response(JSON.stringify(ee(c,n)),{status:i.status,headers:d})}case"subscription":{let n=O(()=>a?e8(a):b?ed(o.data)||T(o.data)?ed(o.data)?ec(o.data,e.req.signal):o.data:e8(new X({message:`Subscription ${t.path} did not return an observable or a AsyncGenerator`,code:"INTERNAL_SERVER_ERROR"})):e8(new X({code:"METHOD_NOT_SUPPORTED",message:'Missing experimental flag "sseSubscriptions"'}))),i=function(e){var t,r,n,a,o;let{serialize:i=_}=e,s={enabled:null!==(t=null===(r=e.ping)||void 0===r?void 0:r.enabled)&&void 0!==t&&t,intervalMs:null!==(n=null===(a=e.ping)||void 0===a?void 0:a.intervalMs)&&void 0!==n?n:1e3},u=null!==(o=e.client)&&void 0!==o?o:{};if(s.enabled&&u.reconnectAfterInactivityMs&&s.intervalMs>u.reconnectAfterInactivityMs)throw Error(`Ping interval must be less than client reconnect interval to prevent unnecessary reconnection - ping.intervalMs: ${s.intervalMs} client.reconnectAfterInactivityMs: ${u.reconnectAfterInactivityMs}`);function l(){return(l=(0,e4.default)(function*(){let t,r;yield{event:"connected",data:JSON.stringify(u)};let n=e.data;e.emitAndEndImmediately&&(n=function(e,t){return ej.apply(this,arguments)}(n,{count:1,gracePeriodMs:1})),e.maxDurationMs&&e.maxDurationMs>0&&e.maxDurationMs!==1/0&&(n=function(e,t){return eU.apply(this,arguments)}(n,{maxDurationMs:e.maxDurationMs})),s.enabled&&s.intervalMs!==1/0&&s.intervalMs>0&&(n=eH(n,s.intervalMs));var a=!1,o=!1;try{for(var l,d,c,f=(0,e2.default)(n);a=!(c=yield(0,e3.default)(f.next())).done;a=!1){if((t=c.value)===eW){yield{event:"ping",data:""};continue}(l=t,r=Array.isArray(l)&&l[2]===el?{id:t[0],data:t[1]}:{data:t}).data=JSON.stringify(i(r.data)),yield r,t=null,r=null}}catch(e){o=!0,d=e}finally{try{a&&null!=f.return&&(yield(0,e3.default)(f.return()))}finally{if(o)throw d}}})).apply(this,arguments)}function d(){return(d=(0,e4.default)(function*(){try{yield*(0,e6.default)((0,e2.default)(function(){return l.apply(this,arguments)}())),yield{event:"return",data:""}}catch(o){var t,r;if(v(o)&&"AbortError"===o.name)return;let n=J(o),a=null!==(t=null===(r=e.formatError)||void 0===r?void 0:r.call(e,{error:n}))&&void 0!==t?t:null;yield{event:"serialized-error",data:JSON.stringify(i(a))}}})).apply(this,arguments)}return eL(function(){return d.apply(this,arguments)}()).pipeThrough(new TransformStream({transform(e,t){"event"in e&&t.enqueue(`event: ${e.event}
`),"data"in e&&t.enqueue(`data: ${e.data}
`),"id"in e&&t.enqueue(`id: ${e.id}
`),"comment"in e&&t.enqueue(`: ${e.comment}
`),t.enqueue("\n\n")}})).pipeThrough(new TextEncoderStream)}((0,e9.default)((0,e9.default)({},c.sse),{},{data:n,serialize:e=>c.transformer.output.serialize(e),formatError(r){var n,a,o;let i=J(r.error),s=null==t?void 0:t.result(),u=null==t?void 0:t.path,l=null!==(n=null==t||null===(a=t.procedure)||void 0===a?void 0:a._def.type)&&void 0!==n?n:"unknown";return null===(o=e.onError)||void 0===o||o.call(e,{error:i,path:u,input:s,ctx:g.valueOrUndefined(),req:e.req,type:l}),H({config:c,ctx:g.valueOrUndefined(),error:i,input:s,path:u,type:l})}}));for(let[e,t]of Object.entries(e7))d.set(e,t);let s=tr({ctx:g.valueOrUndefined(),info:r,responseMeta:e.responseMeta,errors:[],headers:d,untransformedJSON:null});return new Response(i,{headers:d,status:s.status})}}}if("application/jsonl"===r.accept){d.set("content-type","application/json"),d.set("transfer-encoding","chunked");let t=tr({ctx:g.valueOrUndefined(),info:r,responseMeta:e.responseMeta,errors:[],headers:d,untransformedJSON:null}),a=function(e){let t=eL(function(e){return e0.apply(this,arguments)}(e)),{serialize:r}=e;return r&&(t=t.pipeThrough(new TransformStream({transform(e,t){e===eW?t.enqueue(eW):t.enqueue(r(e))}}))),t.pipeThrough(new TransformStream({transform(e,t){e===eW?t.enqueue(" "):t.enqueue(JSON.stringify(e)+"\n")}})).pipeThrough(new TextEncoderStream)}((0,e9.default)((0,e9.default)({},c.jsonl),{},{maxDepth:1/0,data:n.map(async t=>{let[n,a]=await t,o=r.calls[0];if(n){var i,s;return{error:H({config:c,ctx:g.valueOrUndefined(),error:n,input:o.result(),path:o.path,type:null!==(i=null===(s=o.procedure)||void 0===s?void 0:s._def.type)&&void 0!==i?i:"unknown"})}}let u=ed(a.data)?ec(a.data,e.req.signal):Promise.resolve(a.data);return{result:Promise.resolve({data:u})}}),serialize:c.transformer.output.serialize,onError:t=>{var n,a;null===(n=e.onError)||void 0===n||n.call(e,{error:J(t),path:void 0,input:void 0,ctx:g.valueOrUndefined(),req:e.req,type:null!==(a=null==r?void 0:r.type)&&void 0!==a?a:"unknown"})},formatError(e){var t,n;let a=null==r?void 0:r.calls[e.path[0]],o=J(e.error),i=null==a?void 0:a.result(),s=null==a?void 0:a.path,u=null!==(t=null==a||null===(n=a.procedure)||void 0===n?void 0:n._def.type)&&void 0!==t?t:"unknown";return H({config:c,ctx:g.valueOrUndefined(),error:o,input:i,path:s,type:u})}}));return new Response(a,{headers:d,status:t.status})}d.set("content-type","application/json");let a=(await Promise.all(n)).map(e=>{let[t,r]=e;return t?e:tn(r.data)?[new X({code:"UNSUPPORTED_MEDIA_TYPE",message:"Cannot use stream-like response in non-streaming request - use httpBatchStreamLink"}),void 0]:e}),o=a.map(([e,t],n)=>{let a=r.calls[n];if(e){var o,i;return{error:H({config:c,ctx:g.valueOrUndefined(),error:e,input:a.result(),path:a.path,type:null!==(o=null===(i=a.procedure)||void 0===i?void 0:i._def.type)&&void 0!==o?o:"unknown"})}}return{result:{data:t.data}}}),i=a.map(([e])=>e).filter(Boolean),s=tr({ctx:g.valueOrUndefined(),info:r,responseMeta:e.responseMeta,untransformedJSON:o,errors:i,headers:d});return new Response(JSON.stringify(ee(c,o)),{status:s.status,headers:d})}catch(u){let[t,r]=h,n=g.valueOrUndefined(),{error:a,untransformedJSON:o,body:i}=function(e,t){let{router:r,req:n,onError:a}=t.opts,o=J(e);null==a||a({error:o,path:t.path,input:t.input,ctx:t.ctx,type:t.type,req:n});let i={error:H({config:r._def._config,error:o,type:t.type,path:t.path,input:t.input,ctx:t.ctx})},s=JSON.stringify(ee(r._def._config,i));return{error:o,untransformedJSON:i,body:s}}(u,{opts:e,ctx:g.valueOrUndefined(),type:null!==(s=null==r?void 0:r.type)&&void 0!==s?s:"unknown"});return new Response(i,{status:tr({ctx:n,info:r,responseMeta:e.responseMeta,untransformedJSON:o,errors:[a],headers:d}).status,headers:d})}}var to=A(Y(),1);let ti=e=>e=(e=e.startsWith("/")?e.slice(1):e).endsWith("/")?e.slice(0,-1):e;async function ts(e){let t=new Headers,r=async r=>{var n;return null===(n=e.createContext)||void 0===n?void 0:n.call(e,(0,to.default)({req:e.req,resHeaders:t},r))},n=ti(new URL(e.req.url).pathname),a=ti(e.endpoint),o=ti(n.slice(a.length));return await ta((0,to.default)((0,to.default)({},e),{},{req:e.req,createContext:r,path:o,error:null,onError(t){var r;null==e||null===(r=e.onError)||void 0===r||r.call(e,(0,to.default)((0,to.default)({},t),{},{req:e.req}))},responseMeta(r){var n;let a=null===(n=e.responseMeta)||void 0===n?void 0:n.call(e,r);if(null==a?void 0:a.headers){if(a.headers instanceof Headers)for(let[e,r]of a.headers.entries())t.append(e,r);else for(let[e,r]of Object.entries(a.headers))if(Array.isArray(r))for(let n of r)t.append(e,n);else"string"==typeof r&&t.set(e,r)}return{headers:t,status:null==a?void 0:a.status}}}))}var tu=r(4402),tl=A(Y(),1);let td="middlewareMarker";var tc=A(B(),1),tf=class extends Error{constructor(e){var t;super(null===(t=e[0])||void 0===t?void 0:t.message),(0,tc.default)(this,"issues",void 0),this.name="SchemaError",this.issues=e}};function tp(e){let t="~standard"in e;if("function"==typeof e&&"function"==typeof e.assert)return e.assert.bind(e);if("function"==typeof e&&!t)return e;if("function"==typeof e.parseAsync)return e.parseAsync.bind(e);if("function"==typeof e.parse)return e.parse.bind(e);if("function"==typeof e.validateSync)return e.validateSync.bind(e);if("function"==typeof e.create)return e.create.bind(e);if("function"==typeof e.assert)return t=>(e.assert(t),t);if(t)return async t=>{let r=await e["~standard"].validate(t);if(r.issues)throw new tf(r.issues);return r.value};throw Error("Could not find a validator fn")}var tm=N({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/objectWithoutPropertiesLoose.js"(e,t){t.exports=function(e,t){if(null==e)return{};var r={};for(var n in e)if(({}).hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r},t.exports.__esModule=!0,t.exports.default=t.exports}}),th=A(N({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/objectWithoutProperties.js"(e,t){var r=tm();t.exports=function(e,t){if(null==e)return{};var n,a,o=r(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.includes(n)||({}).propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o},t.exports.__esModule=!0,t.exports.default=t.exports}})(),1),tg=A(Y(),1);let ty=["middlewares","inputs","meta"];function tv(e,t){let{middlewares:r=[],inputs:n,meta:a}=t,o=(0,th.default)(t,ty);return tw((0,tg.default)((0,tg.default)({},y(e,o)),{},{inputs:[...e.inputs,...null!=n?n:[]],middlewares:[...e.middlewares,...r],meta:e.meta&&a?(0,tg.default)((0,tg.default)({},e.meta),a):null!=a?a:e.meta}))}function tw(e={}){let t=(0,tg.default)({procedure:!0,inputs:[],middlewares:[]},e);return{_def:t,input(e){let r=tp(e);return tv(t,{inputs:[e],middlewares:[function(e){let t=async function(t){let r;let n=await t.getRawInput();try{r=await e(n)}catch(e){throw new X({code:"BAD_REQUEST",cause:e})}let a=v(t.input)&&v(r)?(0,tl.default)((0,tl.default)({},t.input),r):r;return t.next({input:a})};return t._type="input",t}(r)]})},output(e){let r=tp(e);return tv(t,{output:e,middlewares:[function(e){let t=async function({next:t}){let r=await t();if(!r.ok)return r;try{let t=await e(r.data);return(0,tl.default)((0,tl.default)({},r),{},{data:t})}catch(e){throw new X({message:"Output validation failed",code:"INTERNAL_SERVER_ERROR",cause:e})}};return t._type="output",t}(r)]})},meta:e=>tv(t,{meta:e}),use:e=>tv(t,{middlewares:"_middlewares"in e?e._middlewares:[e]}),unstable_concat:e=>tv(t,e._def),concat:e=>tv(t,e._def),query:e=>tb((0,tg.default)((0,tg.default)({},t),{},{type:"query"}),e),mutation:e=>tb((0,tg.default)((0,tg.default)({},t),{},{type:"mutation"}),e),subscription:e=>tb((0,tg.default)((0,tg.default)({},t),{},{type:"subscription"}),e),experimental_caller:e=>tv(t,{caller:e})}}function tb(e,t){let r=tv(e,{resolver:t,middlewares:[async function(e){return{marker:td,ok:!0,data:await t(e),ctx:e.ctx}}]}),n=(0,tg.default)((0,tg.default)({},r._def),{},{type:e.type,experimental_caller:!!r._def.caller,meta:r._def.meta,$types:null}),a=function(e){async function t(t){if(!t||!("getRawInput"in t))throw Error(tE);let r=await tT(0,e,t);if(!r)throw new X({code:"INTERNAL_SERVER_ERROR",message:"No result from middlewares - did you forget to `return next()`?"});if(!r.ok)throw r.error;return r.data}return t._def=e,t.procedure=!0,t.meta=e.meta,t}(r._def),o=r._def.caller;if(!o)return a;let i=async(...e)=>await o({args:e,invoke:a,_def:n});return i._def=n,i}let tE=`
This is a client-only function.
If you want to call this function on the server, see https://trpc.io/docs/v11/server/server-side-calls
`.trim();async function tT(e,t,r){try{let n=t.middlewares[e];return await n((0,tg.default)((0,tg.default)({},r),{},{meta:t.meta,input:r.input,next(n){var a;return tT(e+1,t,(0,tg.default)((0,tg.default)({},r),{},{ctx:(null==n?void 0:n.ctx)?(0,tg.default)((0,tg.default)({},r.ctx),n.ctx):r.ctx,input:n&&"input"in n?n.input:r.input,getRawInput:null!==(a=null==n?void 0:n.getRawInput)&&void 0!==a?a:r.getRawInput}))}}))}catch(e){return{ok:!1,error:J(e),marker:td}}}let tO="undefined"==typeof window||"Deno"in window||(null===(u=globalThis.process)||void 0===u||null===(u=u.env)||void 0===u?void 0:u.NODE_ENV)==="test"||!!(null===(l=globalThis.process)||void 0===l||null===(l=l.env)||void 0===l?void 0:l.JEST_WORKER_ID)||!!(null===(d=globalThis.process)||void 0===d||null===(d=d.env)||void 0===d?void 0:d.VITEST_WORKER_ID);var t_=A(Y(),1);let tS=new class e{context(){return new e}meta(){return new e}create(e){var t,r,n,a,o,i,s,u;let l=(0,t_.default)((0,t_.default)({},e),{},{transformer:"input"in(u=null!==(t=null==e?void 0:e.transformer)&&void 0!==t?t:K)?u:{input:u,output:u},isDev:null!==(r=null==e?void 0:e.isDev)&&void 0!==r?r:(null===(n=globalThis.process)||void 0===n?void 0:n.env.NODE_ENV)!=="production",allowOutsideOfServer:null!==(a=null==e?void 0:e.allowOutsideOfServer)&&void 0!==a&&a,errorFormatter:null!==(o=null==e?void 0:e.errorFormatter)&&void 0!==o?o:V,isServer:null!==(i=null==e?void 0:e.isServer)&&void 0!==i?i:tO,$types:null});if(!(null!==(s=null==e?void 0:e.isServer)&&void 0!==s?s:tO)&&(null==e?void 0:e.allowOutsideOfServer)!==!0)throw Error("You're trying to use @trpc/server in a non-server environment. This is not supported by default.");return{_config:l,procedure:tw({meta:null==e?void 0:e.defaultMeta}),middleware:function(e){return function e(t){return{_middlewares:t,unstable_pipe:r=>e([...t,..."_middlewares"in r?r._middlewares:[r]])}}([e])},router:eo(l),mergeRouters:eu,createCallerFactory:es()}}};class tz{constructor(){this.keyToValue=new Map,this.valueToKey=new Map}set(e,t){this.keyToValue.set(e,t),this.valueToKey.set(t,e)}getByKey(e){return this.keyToValue.get(e)}getByValue(e){return this.valueToKey.get(e)}clear(){this.keyToValue.clear(),this.valueToKey.clear()}}class tx{constructor(e){this.generateIdentifier=e,this.kv=new tz}register(e,t){this.kv.getByValue(e)||(t||(t=this.generateIdentifier(e)),this.kv.set(t,e))}clear(){this.kv.clear()}getIdentifier(e){return this.kv.getByValue(e)}getValue(e){return this.kv.getByKey(e)}}class tP extends tx{constructor(){super(e=>e.name),this.classToAllowedProps=new Map}register(e,t){"object"==typeof t?(t.allowProps&&this.classToAllowedProps.set(e,t.allowProps),super.register(e,t.identifier)):super.register(e,t)}getAllowedProps(e){return this.classToAllowedProps.get(e)}}function tD(e,t){Object.entries(e).forEach(([e,r])=>t(r,e))}function tR(e,t){return -1!==e.indexOf(t)}function tN(e,t){for(let r=0;r<e.length;r++){let n=e[r];if(t(n))return n}}class tI{constructor(){this.transfomers={}}register(e){this.transfomers[e.name]=e}findApplicable(e){return function(e,t){let r=function(e){if("values"in Object)return Object.values(e);let t=[];for(let r in e)e.hasOwnProperty(r)&&t.push(e[r]);return t}(e);if("find"in r)return r.find(t);for(let e=0;e<r.length;e++){let n=r[e];if(t(n))return n}}(this.transfomers,t=>t.isApplicable(e))}findByName(e){return this.transfomers[e]}}let tA=e=>Object.prototype.toString.call(e).slice(8,-1),tU=e=>void 0===e,tj=e=>null===e,tC=e=>"object"==typeof e&&null!==e&&e!==Object.prototype&&(null===Object.getPrototypeOf(e)||Object.getPrototypeOf(e)===Object.prototype),tM=e=>tC(e)&&0===Object.keys(e).length,tk=e=>Array.isArray(e),tq=e=>"string"==typeof e,tL=e=>"number"==typeof e&&!isNaN(e),tF=e=>"boolean"==typeof e,tB=e=>e instanceof Map,tY=e=>e instanceof Set,tW=e=>"Symbol"===tA(e),tH=e=>"number"==typeof e&&isNaN(e),tV=e=>tF(e)||tj(e)||tU(e)||tL(e)||tq(e)||tW(e),tG=e=>e===1/0||e===-1/0,tQ=e=>e.replace(/\./g,"\\."),tJ=e=>e.map(String).map(tQ).join("."),tX=e=>{let t=[],r="";for(let n=0;n<e.length;n++){let a=e.charAt(n);if("\\"===a&&"."===e.charAt(n+1)){r+=".",n++;continue}if("."===a){t.push(r),r="";continue}r+=a}let n=r;return t.push(n),t};function t$(e,t,r,n){return{isApplicable:e,annotation:t,transform:r,untransform:n}}let tK=[t$(tU,"undefined",()=>null,()=>void 0),t$(e=>"bigint"==typeof e,"bigint",e=>e.toString(),e=>"undefined"!=typeof BigInt?BigInt(e):(console.error("Please add a BigInt polyfill."),e)),t$(e=>e instanceof Date&&!isNaN(e.valueOf()),"Date",e=>e.toISOString(),e=>new Date(e)),t$(e=>e instanceof Error,"Error",(e,t)=>{let r={name:e.name,message:e.message};return t.allowedErrorProps.forEach(t=>{r[t]=e[t]}),r},(e,t)=>{let r=Error(e.message);return r.name=e.name,r.stack=e.stack,t.allowedErrorProps.forEach(t=>{r[t]=e[t]}),r}),t$(e=>e instanceof RegExp,"regexp",e=>""+e,e=>new RegExp(e.slice(1,e.lastIndexOf("/")),e.slice(e.lastIndexOf("/")+1))),t$(tY,"set",e=>[...e.values()],e=>new Set(e)),t$(tB,"map",e=>[...e.entries()],e=>new Map(e)),t$(e=>tH(e)||tG(e),"number",e=>tH(e)?"NaN":e>0?"Infinity":"-Infinity",Number),t$(e=>0===e&&1/e==-1/0,"number",()=>"-0",Number),t$(e=>e instanceof URL,"URL",e=>e.toString(),e=>new URL(e))];function tZ(e,t,r,n){return{isApplicable:e,annotation:t,transform:r,untransform:n}}let t0=tZ((e,t)=>!!tW(e)&&!!t.symbolRegistry.getIdentifier(e),(e,t)=>["symbol",t.symbolRegistry.getIdentifier(e)],e=>e.description,(e,t,r)=>{let n=r.symbolRegistry.getValue(t[1]);if(!n)throw Error("Trying to deserialize unknown symbol");return n}),t1=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,Uint8ClampedArray].reduce((e,t)=>(e[t.name]=t,e),{}),t2=tZ(e=>ArrayBuffer.isView(e)&&!(e instanceof DataView),e=>["typed-array",e.constructor.name],e=>[...e],(e,t)=>{let r=t1[t[1]];if(!r)throw Error("Trying to deserialize unknown typed array");return new r(e)});function t3(e,t){return!!e?.constructor&&!!t.classRegistry.getIdentifier(e.constructor)}let t4=tZ(t3,(e,t)=>["class",t.classRegistry.getIdentifier(e.constructor)],(e,t)=>{let r=t.classRegistry.getAllowedProps(e.constructor);if(!r)return{...e};let n={};return r.forEach(t=>{n[t]=e[t]}),n},(e,t,r)=>{let n=r.classRegistry.getValue(t[1]);if(!n)throw Error(`Trying to deserialize unknown class '${t[1]}' - check https://github.com/blitz-js/superjson/issues/116#issuecomment-773996564`);return Object.assign(Object.create(n.prototype),e)}),t6=tZ((e,t)=>!!t.customTransformerRegistry.findApplicable(e),(e,t)=>["custom",t.customTransformerRegistry.findApplicable(e).name],(e,t)=>t.customTransformerRegistry.findApplicable(e).serialize(e),(e,t,r)=>{let n=r.customTransformerRegistry.findByName(t[1]);if(!n)throw Error("Trying to deserialize unknown custom value");return n.deserialize(e)}),t7=[t4,t0,t6,t2],t5=(e,t)=>{let r=tN(t7,r=>r.isApplicable(e,t));if(r)return{value:r.transform(e,t),type:r.annotation(e,t)};let n=tN(tK,r=>r.isApplicable(e,t));if(n)return{value:n.transform(e,t),type:n.annotation}},t9={};tK.forEach(e=>{t9[e.annotation]=e});let t8=(e,t,r)=>{if(tk(t))switch(t[0]){case"symbol":return t0.untransform(e,t,r);case"class":return t4.untransform(e,t,r);case"custom":return t6.untransform(e,t,r);case"typed-array":return t2.untransform(e,t,r);default:throw Error("Unknown transformation: "+t)}else{let n=t9[t];if(!n)throw Error("Unknown transformation: "+t);return n.untransform(e,r)}},re=(e,t)=>{if(t>e.size)throw Error("index out of bounds");let r=e.keys();for(;t>0;)r.next(),t--;return r.next().value};function rt(e){if(tR(e,"__proto__"))throw Error("__proto__ is not allowed as a property");if(tR(e,"prototype"))throw Error("prototype is not allowed as a property");if(tR(e,"constructor"))throw Error("constructor is not allowed as a property")}let rr=(e,t)=>{rt(t);for(let r=0;r<t.length;r++){let n=t[r];if(tY(e))e=re(e,+n);else if(tB(e)){let a=+n,o=0==+t[++r]?"key":"value",i=re(e,a);switch(o){case"key":e=i;break;case"value":e=e.get(i)}}else e=e[n]}return e},rn=(e,t,r)=>{if(rt(t),0===t.length)return r(e);let n=e;for(let e=0;e<t.length-1;e++){let r=t[e];if(tk(n))n=n[+r];else if(tC(n))n=n[r];else if(tY(n))n=re(n,+r);else if(tB(n)){if(e===t.length-2)break;let a=+r,o=0==+t[++e]?"key":"value",i=re(n,a);switch(o){case"key":n=i;break;case"value":n=n.get(i)}}}let a=t[t.length-1];if(tk(n)?n[+a]=r(n[+a]):tC(n)&&(n[a]=r(n[a])),tY(n)){let e=re(n,+a),t=r(e);e!==t&&(n.delete(e),n.add(t))}if(tB(n)){let e=re(n,+t[t.length-2]);switch(0==+a?"key":"value"){case"key":{let t=r(e);n.set(t,n.get(e)),t!==e&&n.delete(e);break}case"value":n.set(e,r(n.get(e)))}}return e},ra=(e,t)=>tC(e)||tk(e)||tB(e)||tY(e)||t3(e,t),ro=(e,t,r,n,a=[],o=[],i=new Map)=>{let s=tV(e);if(!s){!function(e,t,r){let n=r.get(e);n?n.push(t):r.set(e,[t])}(e,a,t);let r=i.get(e);if(r)return n?{transformedValue:null}:r}if(!ra(e,r)){let t=t5(e,r),n=t?{transformedValue:t.value,annotations:[t.type]}:{transformedValue:e};return s||i.set(e,n),n}if(tR(o,e))return{transformedValue:null};let u=t5(e,r),l=u?.value??e,d=tk(l)?[]:{},c={};tD(l,(s,u)=>{if("__proto__"===u||"constructor"===u||"prototype"===u)throw Error(`Detected property ${u}. This is a prototype pollution risk, please remove it from your object.`);let l=ro(s,t,r,n,[...a,u],[...o,e],i);d[u]=l.transformedValue,tk(l.annotations)?c[u]=l.annotations:tC(l.annotations)&&tD(l.annotations,(e,t)=>{c[tQ(u)+"."+t]=e})});let f=tM(c)?{transformedValue:d,annotations:u?[u.type]:void 0}:{transformedValue:d,annotations:u?[u.type,c]:c};return s||i.set(e,f),f};function ri(e){return Object.prototype.toString.call(e).slice(8,-1)}function rs(e){return"Array"===ri(e)}class ru{constructor({dedupe:e=!1}={}){this.classRegistry=new tP,this.symbolRegistry=new tx(e=>e.description??""),this.customTransformerRegistry=new tI,this.allowedErrorProps=[],this.dedupe=e}serialize(e){let t=new Map,r=ro(e,t,this,this.dedupe),n={json:r.transformedValue};r.annotations&&(n.meta={...n.meta,values:r.annotations});let a=function(e,t){let r;let n={};return(e.forEach(e=>{if(e.length<=1)return;t||(e=e.map(e=>e.map(String)).sort((e,t)=>e.length-t.length));let[a,...o]=e;0===a.length?r=o.map(tJ):n[tJ(a)]=o.map(tJ)}),r)?tM(n)?[r]:[r,n]:tM(n)?void 0:n}(t,this.dedupe);return a&&(n.meta={...n.meta,referentialEqualities:a}),n}deserialize(e){let{json:t,meta:r}=e,n=function e(t,r={}){return rs(t)?t.map(t=>e(t,r)):!function(e){if("Object"!==ri(e))return!1;let t=Object.getPrototypeOf(e);return!!t&&t.constructor===Object&&t===Object.prototype}(t)?t:[...Object.getOwnPropertyNames(t),...Object.getOwnPropertySymbols(t)].reduce((n,a)=>{if(rs(r.props)&&!r.props.includes(a))return n;let o=e(t[a],r);return function(e,t,r,n,a){let o=({}).propertyIsEnumerable.call(n,t)?"enumerable":"nonenumerable";"enumerable"===o&&(e[t]=r),a&&"nonenumerable"===o&&Object.defineProperty(e,t,{value:r,enumerable:!1,writable:!0,configurable:!0})}(n,a,o,t,r.nonenumerable),n},{})}(t);if(r?.values){var a,o,i;a=n,o=r.values,i=this,function e(t,r,n=[]){if(!t)return;if(!tk(t)){tD(t,(t,a)=>e(t,r,[...n,...tX(a)]));return}let[a,o]=t;o&&tD(o,(t,a)=>{e(t,r,[...n,...tX(a)])}),r(a,n)}(o,(e,t)=>{a=rn(a,t,t=>t8(t,e,i))}),n=a}return r?.referentialEqualities&&(n=function(e,t){function r(t,r){let n=rr(e,tX(r));t.map(tX).forEach(t=>{e=rn(e,t,()=>n)})}if(tk(t)){let[n,a]=t;n.forEach(t=>{e=rn(e,tX(t),()=>e)}),a&&tD(a,r)}else tD(t,r);return e}(n,r.referentialEqualities)),n}stringify(e){return JSON.stringify(this.serialize(e))}parse(e){return this.deserialize(JSON.parse(e))}registerClass(e,t){this.classRegistry.register(e,t)}registerSymbol(e,t){this.symbolRegistry.register(e,t)}registerCustom(e,t){this.customTransformerRegistry.register({name:t,...e})}allowErrorProps(...e){this.allowedErrorProps.push(...e)}}ru.defaultInstance=new ru,ru.serialize=ru.defaultInstance.serialize.bind(ru.defaultInstance),ru.deserialize=ru.defaultInstance.deserialize.bind(ru.defaultInstance),ru.stringify=ru.defaultInstance.stringify.bind(ru.defaultInstance),ru.parse=ru.defaultInstance.parse.bind(ru.defaultInstance),ru.registerClass=ru.defaultInstance.registerClass.bind(ru.defaultInstance),ru.registerSymbol=ru.defaultInstance.registerSymbol.bind(ru.defaultInstance),ru.registerCustom=ru.defaultInstance.registerCustom.bind(ru.defaultInstance),ru.allowErrorProps=ru.defaultInstance.allowErrorProps.bind(ru.defaultInstance),ru.serialize,ru.deserialize,ru.stringify,ru.parse,ru.registerClass,ru.registerCustom,ru.registerSymbol,ru.allowErrorProps;var rl=r(2766),rd=r(2644),rc=r(7657);let rf=e=>({session:e.session,db:rd.db}),rp=async e=>rf({session:await (0,rc.W)()}),rm=tS.context().create({transformer:ru,errorFormatter:({shape:e,error:t})=>({...e,data:{...e.data,zodError:t.cause instanceof rl.jm?t.cause.flatten():null}})}),rh=rm.router,rg=rm.procedure,ry=rm.middleware(({ctx:e,next:t})=>{if(!e.session||!e.session.user)throw new X({code:"UNAUTHORIZED"});return t({ctx:{session:{...e.session,user:e.session.user}}})}),rv=rm.middleware(({ctx:e,next:t})=>{if(!e.session||!e.session.user)throw new X({code:"UNAUTHORIZED"});if("ADMIN"!==e.session.user.role)throw new X({code:"FORBIDDEN"});return t({ctx:{session:{...e.session,user:e.session.user}}})}),rw=rm.middleware(({ctx:e,next:t})=>{if(!e.session||!e.session.user)throw new X({code:"UNAUTHORIZED"});if(!e.session.user.active)throw new X({code:"FORBIDDEN",message:"Account is inactive"});return t({ctx:{session:{...e.session,user:e.session.user}}})}),rb=rm.procedure.use(ry).use(rw);rm.procedure.use(rv).use(rw);var rE=r(4750),rT=r.n(rE);let rO=rl.z.object({email:rl.z.string().email("Email inv\xe1lido"),password:rl.z.string().min(6,"Senha deve ter pelo menos 6 caracteres")}),r_=rl.z.object({email:rl.z.string().email("Email inv\xe1lido"),password:rl.z.string().min(6,"Senha deve ter pelo menos 6 caracteres"),name:rl.z.string().min(2,"Nome deve ter pelo menos 2 caracteres")}),rS=rl.z.object({name:rl.z.string().min(1,"Nome \xe9 obrigat\xf3rio"),description:rl.z.string().optional(),price:rl.z.number().min(0,"Pre\xe7o deve ser maior que 0"),category:rl.z.string().min(1,"Categoria \xe9 obrigat\xf3ria"),stock:rl.z.number().min(0,"Estoque n\xe3o pode ser negativo").default(0),minStock:rl.z.number().min(0,"Estoque m\xednimo n\xe3o pode ser negativo").default(0),sku:rl.z.string().optional(),barcode:rl.z.string().optional(),weight:rl.z.number().min(0,"Peso n\xe3o pode ser negativo").optional(),dimensions:rl.z.string().optional(),active:rl.z.boolean().default(!0)});rl.z.object({name:rl.z.string().min(1,"Nome \xe9 obrigat\xf3rio"),description:rl.z.string().optional(),price:rl.z.number().min(0,"Pre\xe7o deve ser maior que 0"),category:rl.z.string().min(1,"Categoria \xe9 obrigat\xf3ria"),duration:rl.z.number().min(0,"Dura\xe7\xe3o n\xe3o pode ser negativa").optional(),active:rl.z.boolean().default(!0)}),rl.z.object({personType:rl.z.enum(["FISICA","JURIDICA"]).default("FISICA"),name:rl.z.string().min(1,"Nome \xe9 obrigat\xf3rio"),tradingName:rl.z.string().optional(),document:rl.z.string().min(1,"Documento \xe9 obrigat\xf3rio"),stateRegistration:rl.z.string().optional(),municipalRegistration:rl.z.string().optional(),zipCode:rl.z.string().optional(),street:rl.z.string().optional(),number:rl.z.string().optional(),complement:rl.z.string().optional(),neighborhood:rl.z.string().optional(),city:rl.z.string().optional(),state:rl.z.string().optional(),phone:rl.z.string().optional(),mobile:rl.z.string().optional(),email:rl.z.string().email("Email inv\xe1lido").optional().or(rl.z.literal("")),contactName:rl.z.string().optional(),contactRole:rl.z.string().optional(),category:rl.z.enum(["POTENTIAL","REGULAR","VIP"]).default("REGULAR"),notes:rl.z.string().optional(),active:rl.z.boolean().default(!0)});let rz=rl.z.object({productId:rl.z.string(),description:rl.z.string().optional(),quantity:rl.z.number().min(1,"Quantidade deve ser maior que 0"),unitPrice:rl.z.number().min(0,"Pre\xe7o unit\xe1rio n\xe3o pode ser negativo"),discount:rl.z.number().min(0,"Desconto n\xe3o pode ser negativo").max(100,"Desconto n\xe3o pode ser maior que 100%").default(0)}),rx=rl.z.object({serviceId:rl.z.string(),description:rl.z.string().optional(),quantity:rl.z.number().min(1,"Quantidade deve ser maior que 0"),unitPrice:rl.z.number().min(0,"Pre\xe7o unit\xe1rio n\xe3o pode ser negativo"),discount:rl.z.number().min(0,"Desconto n\xe3o pode ser negativo").max(100,"Desconto n\xe3o pode ser maior que 100%").default(0)});rl.z.object({clientId:rl.z.string().min(1,"Cliente \xe9 obrigat\xf3rio"),description:rl.z.string().min(1,"Descri\xe7\xe3o \xe9 obrigat\xf3ria"),profitPercentage:rl.z.number().min(0,"Percentual de lucro n\xe3o pode ser negativo").max(100,"Percentual de lucro n\xe3o pode ser maior que 100%").default(0),notes:rl.z.string().optional(),validUntil:rl.z.string().optional(),terms:rl.z.string().optional(),tags:rl.z.array(rl.z.string()).default([]),items:rl.z.array(rz).default([]),serviceItems:rl.z.array(rx).default([])}),rl.z.object({type:rl.z.enum(["INCOME","EXPENSE"]),value:rl.z.number().min(0,"Valor deve ser maior que 0"),description:rl.z.string().min(1,"Descri\xe7\xe3o \xe9 obrigat\xf3ria"),paymentMethod:rl.z.enum(["CASH","DEBIT_CARD","CREDIT_CARD","BANK_TRANSFER","PIX","BOLETO","CHECK"]),category:rl.z.string().min(1,"Categoria \xe9 obrigat\xf3ria"),date:rl.z.string().min(1,"Data \xe9 obrigat\xf3ria"),dueDate:rl.z.string().optional(),status:rl.z.enum(["PENDING","PAID","OVERDUE","CANCELLED"]).default("PENDING"),notes:rl.z.string().optional(),tags:rl.z.array(rl.z.string()).default([]),referenceId:rl.z.string().optional()});let rP=rl.z.object({search:rl.z.string().optional(),page:rl.z.number().min(1).default(1),limit:rl.z.number().min(1).max(100).default(10),sortBy:rl.z.string().optional(),sortOrder:rl.z.enum(["asc","desc"]).default("desc")}),rD=rP.extend({category:rl.z.string().optional(),active:rl.z.boolean().optional(),minPrice:rl.z.number().min(0).optional(),maxPrice:rl.z.number().min(0).optional()});rP.extend({category:rl.z.string().optional(),active:rl.z.boolean().optional(),minPrice:rl.z.number().min(0).optional(),maxPrice:rl.z.number().min(0).optional()}),rP.extend({personType:rl.z.enum(["FISICA","JURIDICA"]).optional(),category:rl.z.enum(["POTENTIAL","REGULAR","VIP"]).optional(),active:rl.z.boolean().optional(),city:rl.z.string().optional(),state:rl.z.string().optional()}),rP.extend({status:rl.z.enum(["DRAFT","PENDING","APPROVED","REJECTED","EXPIRED"]).optional(),clientId:rl.z.string().optional(),minValue:rl.z.number().min(0).optional(),maxValue:rl.z.number().min(0).optional(),dateFrom:rl.z.string().optional(),dateTo:rl.z.string().optional()}),rP.extend({type:rl.z.enum(["INCOME","EXPENSE"]).optional(),status:rl.z.enum(["PENDING","PAID","OVERDUE","CANCELLED"]).optional(),paymentMethod:rl.z.enum(["CASH","DEBIT_CARD","CREDIT_CARD","BANK_TRANSFER","PIX","BOLETO","CHECK"]).optional(),category:rl.z.string().optional(),minValue:rl.z.number().min(0).optional(),maxValue:rl.z.number().min(0).optional(),dateFrom:rl.z.string().optional(),dateTo:rl.z.string().optional()}),rl.z.object({companyName:rl.z.string().optional(),companyDocument:rl.z.string().optional(),companyPhone:rl.z.string().optional(),companyEmail:rl.z.string().email("Email inv\xe1lido").optional().or(rl.z.literal("")),companyAddress:rl.z.string().optional(),companyLogo:rl.z.string().optional()}),rl.z.object({currency:rl.z.string().default("BRL"),dateFormat:rl.z.string().default("DD/MM/YYYY"),timezone:rl.z.string().default("America/Sao_Paulo"),language:rl.z.string().default("pt-BR"),theme:rl.z.string().default("light")}),rl.z.object({emailNotifications:rl.z.boolean().default(!0),quoteExpiration:rl.z.boolean().default(!0),serviceOrderUpdates:rl.z.boolean().default(!0),transactionReminders:rl.z.boolean().default(!0),systemUpdates:rl.z.boolean().default(!1)});let rR=rh({login:rg.input(rO).mutation(async({ctx:e,input:t})=>{let{email:r,password:n}=t,a=await e.db.user.findUnique({where:{email:r}});if(!a||!await rT().compare(n,a.password))throw new X({code:"UNAUTHORIZED",message:"Invalid credentials"});if(!a.active)throw new X({code:"UNAUTHORIZED",message:"Account is inactive"});return await e.db.user.update({where:{id:a.id},data:{lastLogin:new Date}}),await e.db.auditLog.create({data:{userId:a.id,action:"login",module:"auth",details:{email:a.email,loginTime:new Date}}}),{user:{id:a.id,email:a.email,name:a.name,role:a.role,plan:a.plan,active:a.active},message:"Login successful"}}),logout:rb.mutation(async({ctx:e})=>(await e.db.auditLog.create({data:{userId:e.session.user.id,action:"logout",module:"auth",details:{logoutTime:new Date}}}),{message:"Logout successful"})),register:rg.input(r_).mutation(async({ctx:e,input:t})=>{let{email:r,password:n,name:a}=t;if(await e.db.user.findUnique({where:{email:r}}))throw new X({code:"CONFLICT",message:"User already exists"});let o=await rT().hash(n,tu.O.BCRYPT_ROUNDS),i=await e.db.user.create({data:{email:r,name:a,password:o},select:{id:!0,email:!0,name:!0,role:!0,plan:!0,active:!0,createdAt:!0}});return await e.db.auditLog.create({data:{userId:i.id,action:"register",module:"auth",details:{email:i.email,name:i.name}}}),{user:i,message:"User created successfully"}}),getMe:rb.query(async({ctx:e})=>{let t=await e.db.user.findUnique({where:{id:e.session.user.id},select:{id:!0,email:!0,name:!0,role:!0,plan:!0,active:!0,emailVerified:!0,subscriptionStatus:!0,subscriptionExpiresAt:!0,lastLogin:!0,createdAt:!0,updatedAt:!0}});if(!t)throw new X({code:"NOT_FOUND",message:"User not found"});return t}),updateProfile:rb.input(rl.z.object({name:rl.z.string().min(2,"Name must be at least 2 characters"),email:rl.z.string().email("Invalid email")})).mutation(async({ctx:e,input:t})=>{let{name:r,email:n}=t;if(await e.db.user.findFirst({where:{email:n,NOT:{id:e.session.user.id}}}))throw new X({code:"CONFLICT",message:"Email already in use"});let a=await e.db.user.update({where:{id:e.session.user.id},data:{name:r,email:n},select:{id:!0,email:!0,name:!0,role:!0,plan:!0,active:!0,updatedAt:!0}});return await e.db.auditLog.create({data:{userId:e.session.user.id,action:"update_profile",module:"auth",details:{changes:{name:r,email:n}}}}),a}),changePassword:rb.input(rl.z.object({currentPassword:rl.z.string().min(1,"Current password is required"),newPassword:rl.z.string().min(6,"New password must be at least 6 characters")})).mutation(async({ctx:e,input:t})=>{let{currentPassword:r,newPassword:n}=t,a=await e.db.user.findUnique({where:{id:e.session.user.id}});if(!a)throw new X({code:"NOT_FOUND",message:"User not found"});if(!await rT().compare(r,a.password))throw new X({code:"UNAUTHORIZED",message:"Current password is incorrect"});let o=await rT().hash(n,tu.O.BCRYPT_ROUNDS);return await e.db.user.update({where:{id:e.session.user.id},data:{password:o}}),await e.db.auditLog.create({data:{userId:e.session.user.id,action:"change_password",module:"auth",details:{timestamp:new Date}}}),{message:"Password changed successfully"}}),deleteAccount:rb.input(rl.z.object({password:rl.z.string().min(1,"Password is required")})).mutation(async({ctx:e,input:t})=>{let{password:r}=t,n=await e.db.user.findUnique({where:{id:e.session.user.id}});if(!n)throw new X({code:"NOT_FOUND",message:"User not found"});if(!await rT().compare(r,n.password))throw new X({code:"UNAUTHORIZED",message:"Password is incorrect"});return await e.db.auditLog.create({data:{userId:e.session.user.id,action:"delete_account",module:"auth",details:{email:n.email,name:n.name}}}),await e.db.user.delete({where:{id:e.session.user.id}}),{message:"Account deleted successfully"}})});function rN(e){return(rN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rI(e,t){if(t.length<e)throw TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function rA(e){rI(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===rN(e)&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):(("string"==typeof e||"[object String]"===t)&&"undefined"!=typeof console&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(Error().stack)),new Date(NaN))}function rU(e){rI(1,arguments);var t=rA(e);return t.setDate(1),t.setHours(0,0,0,0),t}function rj(e){rI(1,arguments);var t=rA(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function rC(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function rM(e,t){return rI(2,arguments),function(e,t){rI(2,arguments);var r=rA(e),n=rC(t);if(isNaN(n))return new Date(NaN);if(!n)return r;var a=r.getDate(),o=new Date(r.getTime());return(o.setMonth(r.getMonth()+n+1,0),a>=o.getDate())?o:(r.setFullYear(o.getFullYear(),o.getMonth(),a),r)}(e,-rC(t))}function rk(e){rI(1,arguments);var t=rA(e),r=t.getUTCDay();return t.setUTCDate(t.getUTCDate()-((r<1?7:0)+r-1)),t.setUTCHours(0,0,0,0),t}function rq(e){rI(1,arguments);var t=rA(e),r=t.getUTCFullYear(),n=new Date(0);n.setUTCFullYear(r+1,0,4),n.setUTCHours(0,0,0,0);var a=rk(n),o=new Date(0);o.setUTCFullYear(r,0,4),o.setUTCHours(0,0,0,0);var i=rk(o);return t.getTime()>=a.getTime()?r+1:t.getTime()>=i.getTime()?r:r-1}var rL={};function rF(e,t){rI(1,arguments);var r,n,a,o,i,s,u,l,d=rC(null!==(r=null!==(n=null!==(a=null!==(o=null==t?void 0:t.weekStartsOn)&&void 0!==o?o:null==t?void 0:null===(i=t.locale)||void 0===i?void 0:null===(s=i.options)||void 0===s?void 0:s.weekStartsOn)&&void 0!==a?a:rL.weekStartsOn)&&void 0!==n?n:null===(u=rL.locale)||void 0===u?void 0:null===(l=u.options)||void 0===l?void 0:l.weekStartsOn)&&void 0!==r?r:0);if(!(d>=0&&d<=6))throw RangeError("weekStartsOn must be between 0 and 6 inclusively");var c=rA(e),f=c.getUTCDay();return c.setUTCDate(c.getUTCDate()-((f<d?7:0)+f-d)),c.setUTCHours(0,0,0,0),c}function rB(e,t){rI(1,arguments);var r,n,a,o,i,s,u,l,d=rA(e),c=d.getUTCFullYear(),f=rC(null!==(r=null!==(n=null!==(a=null!==(o=null==t?void 0:t.firstWeekContainsDate)&&void 0!==o?o:null==t?void 0:null===(i=t.locale)||void 0===i?void 0:null===(s=i.options)||void 0===s?void 0:s.firstWeekContainsDate)&&void 0!==a?a:rL.firstWeekContainsDate)&&void 0!==n?n:null===(u=rL.locale)||void 0===u?void 0:null===(l=u.options)||void 0===l?void 0:l.firstWeekContainsDate)&&void 0!==r?r:1);if(!(f>=1&&f<=7))throw RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var p=new Date(0);p.setUTCFullYear(c+1,0,f),p.setUTCHours(0,0,0,0);var m=rF(p,t),h=new Date(0);h.setUTCFullYear(c,0,f),h.setUTCHours(0,0,0,0);var g=rF(h,t);return d.getTime()>=m.getTime()?c+1:d.getTime()>=g.getTime()?c:c-1}function rY(e,t){for(var r=Math.abs(e).toString();r.length<t;)r="0"+r;return(e<0?"-":"")+r}let rW={y:function(e,t){var r=e.getUTCFullYear(),n=r>0?r:1-r;return rY("yy"===t?n%100:n,t.length)},M:function(e,t){var r=e.getUTCMonth();return"M"===t?String(r+1):rY(r+1,2)},d:function(e,t){return rY(e.getUTCDate(),t.length)},h:function(e,t){return rY(e.getUTCHours()%12||12,t.length)},H:function(e,t){return rY(e.getUTCHours(),t.length)},m:function(e,t){return rY(e.getUTCMinutes(),t.length)},s:function(e,t){return rY(e.getUTCSeconds(),t.length)},S:function(e,t){var r=t.length;return rY(Math.floor(e.getUTCMilliseconds()*Math.pow(10,r-3)),t.length)}};var rH={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"};function rV(e,t){var r=e>0?"-":"+",n=Math.abs(e),a=Math.floor(n/60),o=n%60;return 0===o?r+String(a):r+String(a)+(t||"")+rY(o,2)}function rG(e,t){return e%60==0?(e>0?"-":"+")+rY(Math.abs(e)/60,2):rQ(e,t)}function rQ(e,t){var r=Math.abs(e);return(e>0?"-":"+")+rY(Math.floor(r/60),2)+(t||"")+rY(r%60,2)}let rJ={G:function(e,t,r){var n=e.getUTCFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if("yo"===t){var n=e.getUTCFullYear();return r.ordinalNumber(n>0?n:1-n,{unit:"year"})}return rW.y(e,t)},Y:function(e,t,r,n){var a=rB(e,n),o=a>0?a:1-a;return"YY"===t?rY(o%100,2):"Yo"===t?r.ordinalNumber(o,{unit:"year"}):rY(o,t.length)},R:function(e,t){return rY(rq(e),t.length)},u:function(e,t){return rY(e.getUTCFullYear(),t.length)},Q:function(e,t,r){var n=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return rY(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){var n=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return rY(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){var n=e.getUTCMonth();switch(t){case"M":case"MM":return rW.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){var n=e.getUTCMonth();switch(t){case"L":return String(n+1);case"LL":return rY(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){var a=function(e,t){rI(1,arguments);var r=rA(e);return Math.round((rF(r,t).getTime()-(function(e,t){rI(1,arguments);var r,n,a,o,i,s,u,l,d=rC(null!==(r=null!==(n=null!==(a=null!==(o=null==t?void 0:t.firstWeekContainsDate)&&void 0!==o?o:null==t?void 0:null===(i=t.locale)||void 0===i?void 0:null===(s=i.options)||void 0===s?void 0:s.firstWeekContainsDate)&&void 0!==a?a:rL.firstWeekContainsDate)&&void 0!==n?n:null===(u=rL.locale)||void 0===u?void 0:null===(l=u.options)||void 0===l?void 0:l.firstWeekContainsDate)&&void 0!==r?r:1),c=rB(e,t),f=new Date(0);return f.setUTCFullYear(c,0,d),f.setUTCHours(0,0,0,0),rF(f,t)})(r,t).getTime())/6048e5)+1}(e,n);return"wo"===t?r.ordinalNumber(a,{unit:"week"}):rY(a,t.length)},I:function(e,t,r){var n=function(e){rI(1,arguments);var t=rA(e);return Math.round((rk(t).getTime()-(function(e){rI(1,arguments);var t=rq(e),r=new Date(0);return r.setUTCFullYear(t,0,4),r.setUTCHours(0,0,0,0),rk(r)})(t).getTime())/6048e5)+1}(e);return"Io"===t?r.ordinalNumber(n,{unit:"week"}):rY(n,t.length)},d:function(e,t,r){return"do"===t?r.ordinalNumber(e.getUTCDate(),{unit:"date"}):rW.d(e,t)},D:function(e,t,r){var n=function(e){rI(1,arguments);var t=rA(e),r=t.getTime();return t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0),Math.floor((r-t.getTime())/864e5)+1}(e);return"Do"===t?r.ordinalNumber(n,{unit:"dayOfYear"}):rY(n,t.length)},E:function(e,t,r){var n=e.getUTCDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){var a=e.getUTCDay(),o=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(o);case"ee":return rY(o,2);case"eo":return r.ordinalNumber(o,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){var a=e.getUTCDay(),o=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(o);case"cc":return rY(o,t.length);case"co":return r.ordinalNumber(o,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){var n=e.getUTCDay(),a=0===n?7:n;switch(t){case"i":return String(a);case"ii":return rY(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){var n=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(n,{width:"narrow",context:"formatting"});default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(e,t,r){var n,a=e.getUTCHours();switch(n=12===a?rH.noon:0===a?rH.midnight:a/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(n,{width:"narrow",context:"formatting"});default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(e,t,r){var n,a=e.getUTCHours();switch(n=a>=17?rH.evening:a>=12?rH.afternoon:a>=4?rH.morning:rH.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(n,{width:"narrow",context:"formatting"});default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(e,t,r){if("ho"===t){var n=e.getUTCHours()%12;return 0===n&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return rW.h(e,t)},H:function(e,t,r){return"Ho"===t?r.ordinalNumber(e.getUTCHours(),{unit:"hour"}):rW.H(e,t)},K:function(e,t,r){var n=e.getUTCHours()%12;return"Ko"===t?r.ordinalNumber(n,{unit:"hour"}):rY(n,t.length)},k:function(e,t,r){var n=e.getUTCHours();return(0===n&&(n=24),"ko"===t)?r.ordinalNumber(n,{unit:"hour"}):rY(n,t.length)},m:function(e,t,r){return"mo"===t?r.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):rW.m(e,t)},s:function(e,t,r){return"so"===t?r.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):rW.s(e,t)},S:function(e,t){return rW.S(e,t)},X:function(e,t,r,n){var a=(n._originalDate||e).getTimezoneOffset();if(0===a)return"Z";switch(t){case"X":return rG(a);case"XXXX":case"XX":return rQ(a);default:return rQ(a,":")}},x:function(e,t,r,n){var a=(n._originalDate||e).getTimezoneOffset();switch(t){case"x":return rG(a);case"xxxx":case"xx":return rQ(a);default:return rQ(a,":")}},O:function(e,t,r,n){var a=(n._originalDate||e).getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+rV(a,":");default:return"GMT"+rQ(a,":")}},z:function(e,t,r,n){var a=(n._originalDate||e).getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+rV(a,":");default:return"GMT"+rQ(a,":")}},t:function(e,t,r,n){return rY(Math.floor((n._originalDate||e).getTime()/1e3),t.length)},T:function(e,t,r,n){return rY((n._originalDate||e).getTime(),t.length)}};var rX=function(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},r$=function(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}};let rK={p:r$,P:function(e,t){var r,n=e.match(/(P+)(p+)?/)||[],a=n[1],o=n[2];if(!o)return rX(e,t);switch(a){case"P":r=t.dateTime({width:"short"});break;case"PP":r=t.dateTime({width:"medium"});break;case"PPP":r=t.dateTime({width:"long"});break;default:r=t.dateTime({width:"full"})}return r.replace("{{date}}",rX(a,t)).replace("{{time}}",r$(o,t))}};var rZ=["D","DD"],r0=["YY","YYYY"];function r1(e,t,r){if("YYYY"===e)throw RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("YY"===e)throw RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("D"===e)throw RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("DD"===e)throw RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var r2={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function r3(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}var r4={date:r3({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:r3({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:r3({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},r6={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function r7(e){return function(t,r){var n;if("formatting"===(null!=r&&r.context?String(r.context):"standalone")&&e.formattingValues){var a=e.defaultFormattingWidth||e.defaultWidth,o=null!=r&&r.width?String(r.width):a;n=e.formattingValues[o]||e.formattingValues[a]}else{var i=e.defaultWidth,s=null!=r&&r.width?String(r.width):e.defaultWidth;n=e.values[s]||e.values[i]}return n[e.argumentCallback?e.argumentCallback(t):t]}}function r5(e){return function(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=n.width,o=a&&e.matchPatterns[a]||e.matchPatterns[e.defaultMatchWidth],i=t.match(o);if(!i)return null;var s=i[0],u=a&&e.parsePatterns[a]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(u)?function(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return r}(u,function(e){return e.test(s)}):function(e,t){for(var r in e)if(e.hasOwnProperty(r)&&t(e[r]))return r}(u,function(e){return e.test(s)});return r=e.valueCallback?e.valueCallback(l):l,{value:r=n.valueCallback?n.valueCallback(r):r,rest:t.slice(s.length)}}}let r9={code:"en-US",formatDistance:function(e,t,r){var n,a=r2[e];return(n="string"==typeof a?a:1===t?a.one:a.other.replace("{{count}}",t.toString()),null!=r&&r.addSuffix)?r.comparison&&r.comparison>0?"in "+n:n+" ago":n},formatLong:r4,formatRelative:function(e,t,r,n){return r6[e]},localize:{ordinalNumber:function(e,t){var r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},era:r7({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:r7({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:r7({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:r7({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:r7({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:function(e){return function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.match(e.matchPattern);if(!n)return null;var a=n[0],o=t.match(e.parsePattern);if(!o)return null;var i=e.valueCallback?e.valueCallback(o[0]):o[0];return{value:i=r.valueCallback?r.valueCallback(i):i,rest:t.slice(a.length)}}}({matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}}),era:r5({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:r5({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:r5({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:r5({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:r5({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}};var r8=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,ne=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,nt=/^'([^]*?)'?$/,nr=/''/g,nn=/[a-zA-Z]/;let na=rh({getStats:rb.query(async({ctx:e})=>{let t=e.session.user.id,r=new Date,n=rU(r),a=rj(r),[o,i,s,u,l,d,c,f]=await Promise.all([e.db.quote.count({where:{userId:t}}),e.db.client.count({where:{userId:t,active:!0}}),e.db.product.count({where:{userId:t,active:!0}}),e.db.service.count({where:{userId:t,active:!0}}),e.db.quote.count({where:{userId:t,status:"PENDING"}}),e.db.serviceOrder.count({where:{userId:t,status:"IN_PROGRESS"}}),e.db.transaction.aggregate({where:{userId:t,type:"INCOME",date:{gte:n,lte:a}},_sum:{value:!0}}),e.db.transaction.aggregate({where:{userId:t,type:"EXPENSE",date:{gte:n,lte:a}},_sum:{value:!0}})]);return{totalQuotes:o,totalClients:i,totalProducts:s,totalServices:u,pendingQuotes:l,activeServiceOrders:d,monthlyRevenue:c._sum.value||0,monthlyExpenses:f._sum.value||0}}),getCharts:rb.query(async({ctx:e})=>{let t=e.session.user.id,r=new Date,n=[];for(let a=5;a>=0;a--){let o=rM(r,a),i=rU(o),s=rj(o),u=await e.db.transaction.aggregate({where:{userId:t,type:"INCOME",date:{gte:i,lte:s}},_sum:{value:!0}}),l=await e.db.transaction.aggregate({where:{userId:t,type:"EXPENSE",date:{gte:i,lte:s}},_sum:{value:!0}});n.push({name:function(e,t,r){rI(2,arguments);var n,a,o,i,s,u,l,d,c,f,p,m,h,g,y,v,w,b,E,T=String(t),O=null!==(a=null!==(o=null==r?void 0:r.locale)&&void 0!==o?o:rL.locale)&&void 0!==a?a:r9,_=rC(null!==(i=null!==(s=null!==(u=null!==(l=null==r?void 0:r.firstWeekContainsDate)&&void 0!==l?l:null==r?void 0:null===(d=r.locale)||void 0===d?void 0:null===(c=d.options)||void 0===c?void 0:c.firstWeekContainsDate)&&void 0!==u?u:rL.firstWeekContainsDate)&&void 0!==s?s:null===(f=rL.locale)||void 0===f?void 0:null===(p=f.options)||void 0===p?void 0:p.firstWeekContainsDate)&&void 0!==i?i:1);if(!(_>=1&&_<=7))throw RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var S=rC(null!==(m=null!==(h=null!==(g=null!==(y=null==r?void 0:r.weekStartsOn)&&void 0!==y?y:null==r?void 0:null===(v=r.locale)||void 0===v?void 0:null===(w=v.options)||void 0===w?void 0:w.weekStartsOn)&&void 0!==g?g:rL.weekStartsOn)&&void 0!==h?h:null===(b=rL.locale)||void 0===b?void 0:null===(E=b.options)||void 0===E?void 0:E.weekStartsOn)&&void 0!==m?m:0);if(!(S>=0&&S<=6))throw RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!O.localize)throw RangeError("locale must contain localize property");if(!O.formatLong)throw RangeError("locale must contain formatLong property");var z=rA(e);if(!function(e){return rI(1,arguments),(!!function(e){return rI(1,arguments),e instanceof Date||"object"===rN(e)&&"[object Date]"===Object.prototype.toString.call(e)}(e)||"number"==typeof e)&&!isNaN(Number(rA(e)))}(z))throw RangeError("Invalid time value");var x=((n=new Date(Date.UTC(z.getFullYear(),z.getMonth(),z.getDate(),z.getHours(),z.getMinutes(),z.getSeconds(),z.getMilliseconds()))).setUTCFullYear(z.getFullYear()),z.getTime()-n.getTime()),P=function(e,t){return rI(2,arguments),function(e,t){return rI(2,arguments),new Date(rA(e).getTime()+rC(t))}(e,-rC(t))}(z,x),D={firstWeekContainsDate:_,weekStartsOn:S,locale:O,_originalDate:z};return T.match(ne).map(function(e){var t=e[0];return"p"===t||"P"===t?(0,rK[t])(e,O.formatLong):e}).join("").match(r8).map(function(n){if("''"===n)return"'";var a=n[0];if("'"===a)return function(e){var t=e.match(nt);return t?t[1].replace(nr,"'"):e}(n);var o=rJ[a];if(o)return null!=r&&r.useAdditionalWeekYearTokens||-1===r0.indexOf(n)||r1(n,t,String(e)),null!=r&&r.useAdditionalDayOfYearTokens||-1===rZ.indexOf(n)||r1(n,t,String(e)),o(P,n,O.localize,D);if(a.match(nn))throw RangeError("Format string contains an unescaped latin alphabet character `"+a+"`");return n}).join("")}(o,"MMM yyyy"),income:u._sum.value||0,expense:l._sum.value||0})}let a=(await e.db.quote.groupBy({by:["status"],where:{userId:t},_count:{status:!0}})).map(e=>({name:e.status,value:e._count.status})),o=await e.db.quoteItem.groupBy({by:["productId"],where:{quote:{userId:t}},_count:{productId:!0},_sum:{quantity:!0},orderBy:{_count:{productId:"desc"}},take:5});return{revenueData:n,statusData:a,productData:await Promise.all(o.map(async t=>{let r=await e.db.product.findUnique({where:{id:t.productId},select:{name:!0}});return{name:r?.name||"Unknown",value:t._sum.quantity||0}}))}}),getRecentQuotes:rb.input(rl.z.object({limit:rl.z.number().min(1).max(20).default(5)})).query(async({ctx:e,input:t})=>await e.db.quote.findMany({where:{userId:e.session.user.id},orderBy:{createdAt:"desc"},take:t.limit,include:{client:{select:{name:!0,email:!0}}}})),getPerformance:rb.query(async({ctx:e})=>{let t=e.session.user.id,r=new Date,n=rU(r),a=rj(r),o=rU(rM(r,1)),i=rj(rM(r,1)),[s,u,l,d,c,f]=await Promise.all([e.db.quote.count({where:{userId:t,createdAt:{gte:n,lte:a}}}),e.db.quote.count({where:{userId:t,createdAt:{gte:o,lte:i}}}),e.db.transaction.aggregate({where:{userId:t,type:"INCOME",date:{gte:n,lte:a}},_sum:{value:!0}}),e.db.transaction.aggregate({where:{userId:t,type:"INCOME",date:{gte:o,lte:i}},_sum:{value:!0}}),e.db.client.count({where:{userId:t,createdAt:{gte:n,lte:a}}}),e.db.client.count({where:{userId:t,createdAt:{gte:o,lte:i}}})]),p=(e,t)=>0===t?e>0?100:0:(e-t)/t*100;return{quotes:{current:s,previous:u,growth:p(s,u)},revenue:{current:l._sum.value||0,previous:d._sum.value||0,growth:p(Number(l._sum.value)||0,Number(d._sum.value)||0)},clients:{current:c,previous:f,growth:p(c,f)}}})}),no=rh({list:rb.input(rD).query(async({ctx:e,input:t})=>{let{search:r,category:n,active:a,minPrice:o,maxPrice:i,page:s,limit:u,sortBy:l,sortOrder:d}=t,c={userId:e.session.user.id,...r&&{OR:[{name:{contains:r,mode:"insensitive"}},{description:{contains:r,mode:"insensitive"}},{sku:{contains:r,mode:"insensitive"}}]},...n&&{category:n},...void 0!==a&&{active:a},...void 0!==o&&{price:{gte:o}},...void 0!==i&&{price:{lte:i}}},[f,p]=await Promise.all([e.db.product.findMany({where:c,orderBy:{[l||"createdAt"]:d},skip:(s-1)*u,take:u}),e.db.product.count({where:c})]);return{data:f,pagination:{page:s,limit:u,total:p,pages:Math.ceil(p/u)}}}),get:rb.input(rl.z.object({id:rl.z.string()})).query(async({ctx:e,input:t})=>{let r=await e.db.product.findFirst({where:{id:t.id,userId:e.session.user.id}});if(!r)throw new X({code:"NOT_FOUND",message:"Product not found"});return r}),create:rb.input(rS).mutation(async({ctx:e,input:t})=>{let r=await e.db.product.create({data:{...t,userId:e.session.user.id}});return await e.db.auditLog.create({data:{userId:e.session.user.id,action:"create",module:"products",details:{productId:r.id,name:r.name}}}),r}),update:rb.input(rl.z.object({id:rl.z.string(),data:rS.partial()})).mutation(async({ctx:e,input:t})=>{if(!await e.db.product.findFirst({where:{id:t.id,userId:e.session.user.id}}))throw new X({code:"NOT_FOUND",message:"Product not found"});let r=await e.db.product.update({where:{id:t.id},data:t.data});return await e.db.auditLog.create({data:{userId:e.session.user.id,action:"update",module:"products",details:{productId:r.id,changes:t.data}}}),r}),delete:rb.input(rl.z.object({id:rl.z.string()})).mutation(async({ctx:e,input:t})=>{let r=await e.db.product.findFirst({where:{id:t.id,userId:e.session.user.id}});if(!r)throw new X({code:"NOT_FOUND",message:"Product not found"});if(await e.db.quoteItem.count({where:{productId:t.id}})>0)throw new X({code:"PRECONDITION_FAILED",message:"Cannot delete product that is used in quotes"});return await e.db.product.delete({where:{id:t.id}}),await e.db.auditLog.create({data:{userId:e.session.user.id,action:"delete",module:"products",details:{productId:t.id,name:r.name}}}),{message:"Product deleted successfully"}}),search:rb.input(rl.z.object({query:rl.z.string().min(1),limit:rl.z.number().min(1).max(50).default(10)})).query(async({ctx:e,input:t})=>await e.db.product.findMany({where:{userId:e.session.user.id,active:!0,OR:[{name:{contains:t.query,mode:"insensitive"}},{description:{contains:t.query,mode:"insensitive"}},{sku:{contains:t.query,mode:"insensitive"}}]},take:t.limit,orderBy:{name:"asc"}})),getCategories:rb.query(async({ctx:e})=>(await e.db.product.findMany({where:{userId:e.session.user.id,active:!0},select:{category:!0},distinct:["category"],orderBy:{category:"asc"}})).map(e=>e.category)),getLowStock:rb.query(async({ctx:e})=>await e.db.product.findMany({where:{userId:e.session.user.id,active:!0,stock:{lte:e.db.product.fields.minStock}},orderBy:{stock:"asc"}})),updateStock:rb.input(rl.z.object({id:rl.z.string(),stock:rl.z.number().min(0)})).mutation(async({ctx:e,input:t})=>{let r=await e.db.product.findFirst({where:{id:t.id,userId:e.session.user.id}});if(!r)throw new X({code:"NOT_FOUND",message:"Product not found"});let n=await e.db.product.update({where:{id:t.id},data:{stock:t.stock}});return await e.db.auditLog.create({data:{userId:e.session.user.id,action:"update_stock",module:"products",details:{productId:n.id,oldStock:r.stock,newStock:t.stock}}}),n})}),ni=rh({getAll:rb.query(async({ctx:e})=>await e.db.service.findMany({where:{userId:e.session.user.id},orderBy:{createdAt:"desc"}})),getById:rb.input(rl.z.object({id:rl.z.string()})).query(async({ctx:e,input:t})=>{let r=await e.db.service.findFirst({where:{id:t.id,userId:e.session.user.id}});if(!r)throw new X({code:"NOT_FOUND",message:"Service not found"});return r}),create:rb.input(rl.z.object({name:rl.z.string().min(1),description:rl.z.string().optional(),price:rl.z.number().min(0),category:rl.z.string().min(1),duration:rl.z.number().optional(),active:rl.z.boolean().default(!0)})).mutation(async({ctx:e,input:t})=>{let r=await e.db.service.create({data:{...t,userId:e.session.user.id}});return await e.db.auditLog.create({data:{userId:e.session.user.id,action:"create_service",module:"services",details:{serviceId:r.id,serviceName:r.name}}}),r}),update:rb.input(rl.z.object({id:rl.z.string(),name:rl.z.string().min(1),description:rl.z.string().optional(),price:rl.z.number().min(0),category:rl.z.string().min(1),duration:rl.z.number().optional(),active:rl.z.boolean().optional()})).mutation(async({ctx:e,input:t})=>{let{id:r,...n}=t,a=await e.db.service.findFirst({where:{id:r,userId:e.session.user.id}});if(!a)throw new X({code:"NOT_FOUND",message:"Service not found"});let o=await e.db.service.update({where:{id:r},data:n});return await e.db.auditLog.create({data:{userId:e.session.user.id,action:"update_service",module:"services",details:{serviceId:a.id,changes:n}}}),o}),delete:rb.input(rl.z.object({id:rl.z.string()})).mutation(async({ctx:e,input:t})=>{let r=await e.db.service.findFirst({where:{id:t.id,userId:e.session.user.id}});if(!r)throw new X({code:"NOT_FOUND",message:"Service not found"});return await e.db.service.delete({where:{id:t.id}}),await e.db.auditLog.create({data:{userId:e.session.user.id,action:"delete_service",module:"services",details:{serviceId:r.id,serviceName:r.name}}}),{message:"Service deleted successfully"}})}),ns=rh({getAll:rb.query(async({ctx:e})=>await e.db.client.findMany({where:{userId:e.session.user.id},orderBy:{createdAt:"desc"}})),getById:rb.input(rl.z.object({id:rl.z.string()})).query(async({ctx:e,input:t})=>{let r=await e.db.client.findFirst({where:{id:t.id,userId:e.session.user.id}});if(!r)throw new X({code:"NOT_FOUND",message:"Client not found"});return r}),create:rb.input(rl.z.object({name:rl.z.string().min(1),document:rl.z.string().min(1),personType:rl.z.enum(["FISICA","JURIDICA"]).optional(),tradingName:rl.z.string().optional(),email:rl.z.string().email().optional(),phone:rl.z.string().optional(),mobile:rl.z.string().optional(),zipCode:rl.z.string().optional(),street:rl.z.string().optional(),number:rl.z.string().optional(),complement:rl.z.string().optional(),neighborhood:rl.z.string().optional(),city:rl.z.string().optional(),state:rl.z.string().optional(),contactName:rl.z.string().optional(),contactRole:rl.z.string().optional(),category:rl.z.enum(["POTENTIAL","REGULAR","VIP"]).optional(),notes:rl.z.string().optional()})).mutation(async({ctx:e,input:t})=>{let r=await e.db.client.create({data:{...t,userId:e.session.user.id}});return await e.db.auditLog.create({data:{userId:e.session.user.id,action:"create_client",module:"clients",details:{clientId:r.id,clientName:r.name}}}),r}),update:rb.input(rl.z.object({id:rl.z.string(),name:rl.z.string().min(1),document:rl.z.string().min(1),personType:rl.z.enum(["FISICA","JURIDICA"]).optional(),tradingName:rl.z.string().optional(),email:rl.z.string().email().optional(),phone:rl.z.string().optional(),mobile:rl.z.string().optional(),zipCode:rl.z.string().optional(),street:rl.z.string().optional(),number:rl.z.string().optional(),complement:rl.z.string().optional(),neighborhood:rl.z.string().optional(),city:rl.z.string().optional(),state:rl.z.string().optional(),contactName:rl.z.string().optional(),contactRole:rl.z.string().optional(),category:rl.z.enum(["POTENTIAL","REGULAR","VIP"]).optional(),notes:rl.z.string().optional()})).mutation(async({ctx:e,input:t})=>{let{id:r,...n}=t,a=await e.db.client.findFirst({where:{id:r,userId:e.session.user.id}});if(!a)throw new X({code:"NOT_FOUND",message:"Client not found"});let o=await e.db.client.update({where:{id:r},data:n});return await e.db.auditLog.create({data:{userId:e.session.user.id,action:"update_client",module:"clients",details:{clientId:a.id,changes:n}}}),o}),delete:rb.input(rl.z.object({id:rl.z.string()})).mutation(async({ctx:e,input:t})=>{let r=await e.db.client.findFirst({where:{id:t.id,userId:e.session.user.id}});if(!r)throw new X({code:"NOT_FOUND",message:"Client not found"});return await e.db.client.delete({where:{id:t.id}}),await e.db.auditLog.create({data:{userId:e.session.user.id,action:"delete_client",module:"clients",details:{clientId:r.id,clientName:r.name}}}),{message:"Client deleted successfully"}})}),nu=rh({auth:rR,dashboard:na,products:no,services:ni,clients:ns}),nl=e=>ts({endpoint:"/api/trpc",req:e,router:nu,createContext:()=>rp({req:e,res:void 0}),onError:"development"===tu.O.NODE_ENV?({path:e,error:t})=>{console.error(` tRPC failed on ${e??"<no-path>"}: ${t.message}`)}:void 0}),nd=new f.AppRouteRouteModule({definition:{kind:p.x.APP_ROUTE,page:"/api/trpc/[trpc]/route",pathname:"/api/trpc/[trpc]",filename:"route",bundlePath:"app/api/trpc/[trpc]/route"},resolvedPagePath:"C:\\Projetos Cursor\\metalgest\\apps\\server\\src\\app\\api\\trpc\\[trpc]\\route.ts",nextConfigOutput:"",userland:c}),{requestAsyncStorage:nc,staticGenerationAsyncStorage:nf,serverHooks:np}=nd,nm="/api/trpc/[trpc]/route";function nh(){return(0,m.patchFetch)({serverHooks:np,staticGenerationAsyncStorage:nf})}},7657:(e,t,r)=>{r.d(t,{L:()=>d,W:()=>c});var n=r(9224),a=r(391),o=r(8452),i=r(4750),s=r.n(i),u=r(2644),l=r(4402);let d={callbacks:{session:({session:e,token:t})=>({...e,user:{...e.user,id:t.sub,role:t.role,plan:t.plan,active:t.active}}),jwt:({token:e,user:t})=>(t&&(e.role=t.role,e.plan=t.plan,e.active=t.active),e)},adapter:(0,a.N)(u.db),providers:[(0,o.Z)({name:"credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)return null;let t=await u.db.user.findUnique({where:{email:e.email}});return t&&t.active&&await s().compare(e.password,t.password)?(await u.db.user.update({where:{id:t.id},data:{lastLogin:new Date}}),{id:t.id,email:t.email,name:t.name,role:t.role,plan:t.plan,active:t.active}):null}})],session:{strategy:"jwt"},secret:l.O.NEXTAUTH_SECRET,pages:{signIn:"/auth/signin"}},c=()=>(0,n.getServerSession)(d)},2644:(e,t,r)=>{r.d(t,{db:()=>a});let n=require("@prisma/client"),a=globalThis.prisma??new n.PrismaClient},4402:(e,t,r)=>{r.d(t,{O:()=>o});var n=r(3517),a=r(2766);let o=(0,n.D)({server:{DATABASE_URL:a.z.string().url(),NODE_ENV:a.z.enum(["development","test","production"]),NEXTAUTH_SECRET:a.z.string(),NEXTAUTH_URL:a.z.preprocess(e=>process.env.VERCEL_URL??e,process.env.VERCEL?a.z.string():a.z.string().url()),JWT_SECRET:a.z.string(),BCRYPT_ROUNDS:a.z.coerce.number().default(12)},client:{},runtimeEnv:{DATABASE_URL:process.env.DATABASE_URL,NODE_ENV:"production",NEXTAUTH_SECRET:process.env.NEXTAUTH_SECRET,NEXTAUTH_URL:process.env.NEXTAUTH_URL,JWT_SECRET:process.env.JWT_SECRET,BCRYPT_ROUNDS:process.env.BCRYPT_ROUNDS},skipValidation:!!process.env.SKIP_ENV_VALIDATION,emptyStringAsUndefined:!0})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[833,57],()=>r(8280));module.exports=n})();