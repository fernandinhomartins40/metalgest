"use strict";(()=>{var e={};e.id=912,e.ids=[912],e.modules={2934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7790:e=>{e.exports=require("assert")},8893:e=>{e.exports=require("buffer")},4770:e=>{e.exports=require("crypto")},7702:e=>{e.exports=require("events")},2615:e=>{e.exports=require("http")},5240:e=>{e.exports=require("https")},6624:e=>{e.exports=require("querystring")},7360:e=>{e.exports=require("url")},1764:e=>{e.exports=require("util")},1568:e=>{e.exports=require("zlib")},1327:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>m,patchFetch:()=>v,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>T,staticGenerationAsyncStorage:()=>E});var s={};t.r(s),t.d(s,{GET:()=>l,POST:()=>l});var a=t(3036),i=t(5736),n=t(5262),o=t(9224),p=t.n(o),u=t(7657);let l=p()(u.L),c=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/auth/[...nextauth]/route",pathname:"/api/auth/[...nextauth]",filename:"route",bundlePath:"app/api/auth/[...nextauth]/route"},resolvedPagePath:"C:\\Projetos Cursor\\metalgest\\apps\\server\\src\\app\\api\\auth\\[...nextauth]\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:d,staticGenerationAsyncStorage:E,serverHooks:T}=c,m="/api/auth/[...nextauth]/route";function v(){return(0,n.patchFetch)({serverHooks:T,staticGenerationAsyncStorage:E})}},7657:(e,r,t)=>{t.d(r,{L:()=>l,W:()=>c});var s=t(9224),a=t(391),i=t(8452),n=t(4750),o=t.n(n),p=t(2644),u=t(4402);let l={callbacks:{session:({session:e,token:r})=>({...e,user:{...e.user,id:r.sub,role:r.role,plan:r.plan,active:r.active}}),jwt:({token:e,user:r})=>(r&&(e.role=r.role,e.plan=r.plan,e.active=r.active),e)},adapter:(0,a.N)(p.db),providers:[(0,i.Z)({name:"credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)return null;let r=await p.db.user.findUnique({where:{email:e.email}});return r&&r.active&&await o().compare(e.password,r.password)?(await p.db.user.update({where:{id:r.id},data:{lastLogin:new Date}}),{id:r.id,email:r.email,name:r.name,role:r.role,plan:r.plan,active:r.active}):null}})],session:{strategy:"jwt"},secret:u.O.NEXTAUTH_SECRET,pages:{signIn:"/auth/signin"}},c=()=>(0,s.getServerSession)(l)},2644:(e,r,t)=>{t.d(r,{db:()=>a});let s=require("@prisma/client"),a=globalThis.prisma??new s.PrismaClient},4402:(e,r,t)=>{t.d(r,{O:()=>i});var s=t(3517),a=t(2766);let i=(0,s.D)({server:{DATABASE_URL:a.z.string().url(),NODE_ENV:a.z.enum(["development","test","production"]),NEXTAUTH_SECRET:a.z.string(),NEXTAUTH_URL:a.z.preprocess(e=>process.env.VERCEL_URL??e,process.env.VERCEL?a.z.string():a.z.string().url()),JWT_SECRET:a.z.string(),BCRYPT_ROUNDS:a.z.coerce.number().default(12)},client:{},runtimeEnv:{DATABASE_URL:process.env.DATABASE_URL,NODE_ENV:"production",NEXTAUTH_SECRET:process.env.NEXTAUTH_SECRET,NEXTAUTH_URL:process.env.NEXTAUTH_URL,JWT_SECRET:process.env.JWT_SECRET,BCRYPT_ROUNDS:process.env.BCRYPT_ROUNDS},skipValidation:!!process.env.SKIP_ENV_VALIDATION,emptyStringAsUndefined:!0})}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[833,57],()=>t(1327));module.exports=s})();