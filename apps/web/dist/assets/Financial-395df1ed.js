import{c as B,d as ee,R as r,j as e,B as j,F as se}from"./index-3e5870c5.js";import{u as ae}from"./index.esm-04cc717d.js";import{o as te,s as o,e as re,n as ie,t as ne,T as le,a as ce,b,c as w}from"./tabs-21993d5d.js";import{C as i,b as n,c as l,a as c,d as u}from"./card-0f409810.js";import{u as y,D as de}from"./useApi-5cb55952.js";import{a as v}from"./api-a6c5b2a0.js";import{f as p}from"./index-0bd7da91.js";import{T as oe}from"./trending-up-1f2dc612.js";import{T as me,L as xe,a as pe}from"./LineChart-fa0785fb.js";import{A as he,B as je}from"./BarChart-3c6d8656.js";import{R as C,C as T,X as D,Y as S,T as R,L as F,B as M}from"./generateCategoricalChart-4b073a80.js";import"./isEqual-aeb8bf80.js";const k=B("ArrowDownCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]]),A=B("ArrowUpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]),ue=te({date:o().min(1,"Data é obrigatória"),type:re(["income","expense"]),value:ie().min(.01,"Valor deve ser maior que zero"),description:o().min(3,"Descrição deve ter no mínimo 3 caracteres"),paymentMethod:o().min(1,"Forma de pagamento é obrigatória"),category:o().min(1,"Categoria é obrigatória"),notes:o().optional()}),ye=["Dinheiro","Cartão de Crédito","Cartão de Débito","Transferência","PIX","Boleto"],E=["Receita de Vendas de Produtos","Receita de Prestação de Serviços","Outras Receitas Operacionais","Receita Financeira"],L=["CMV - Custo de Mercadoria Vendida","Custo de Serviços Prestados","Despesas com Pessoal","Despesas Administrativas","Despesas Comerciais","Despesas Operacionais","Despesas Financeiras","Tributos e Impostos","Outras Despesas"];function ke(){const{toast:m}=ee(),{execute:V,loading:g}=y(v.financial.create),{execute:$,loading:P}=y(v.financial.list),{execute:I,loading:ve}=y(v.financial.getSummary),[x,K]=r.useState([]),[d,O]=r.useState({totalIncome:0,totalExpense:0,netBalance:0,categorySummary:{}}),{register:t,handleSubmit:z,watch:q,reset:U,formState:{errors:a}}=ae({resolver:ne(ue),defaultValues:{type:"income",date:p(new Date,"yyyy-MM-dd")}}),[X,H]=r.useState("week"),[Y,G]=r.useState("all"),[J,Q]=r.useState(""),W=q("type");r.useEffect(()=>{f(),N()},[]);const f=async()=>{try{const s=await $();K(s)}catch(s){console.error("Error loading transactions:",s),m({variant:"destructive",title:"Erro ao carregar transações",description:s.message})}},N=async()=>{try{const s=p(new Date().setDate(1),"yyyy-MM-dd"),h=p(new Date,"yyyy-MM-dd"),_=await I(s,h);O(_)}catch(s){console.error("Error loading summary:",s),m({variant:"destructive",title:"Erro ao carregar resumo",description:s.message})}},Z=async s=>{try{await V(s),m({title:"Lançamento registrado com sucesso!",description:`${s.type==="income"?"Entrada":"Saída"} de R$ ${s.value} registrada.`}),U(),f(),N()}catch(h){m({variant:"destructive",title:"Erro ao registrar lançamento",description:h.message})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Financeiro"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(j,{variant:"outline",size:"sm",children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),"Exportar"]}),e.jsxs(j,{variant:"outline",size:"sm",children:[e.jsx(se,{className:"w-4 h-4 mr-2"}),"Relatório"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(i,{children:[e.jsxs(n,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium",children:"Receitas"}),e.jsx(A,{className:"h-4 w-4 text-green-500"})]}),e.jsx(c,{children:e.jsxs("div",{className:"text-2xl font-bold",children:["R$ ",d.totalIncome.toFixed(2)]})})]}),e.jsxs(i,{children:[e.jsxs(n,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium",children:"Despesas"}),e.jsx(k,{className:"h-4 w-4 text-red-500"})]}),e.jsx(c,{children:e.jsxs("div",{className:"text-2xl font-bold",children:["R$ ",d.totalExpense.toFixed(2)]})})]}),e.jsxs(i,{children:[e.jsxs(n,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium",children:"Saldo"}),d.netBalance>=0?e.jsx(oe,{className:"h-4 w-4 text-green-500"}):e.jsx(me,{className:"h-4 w-4 text-red-500"})]}),e.jsx(c,{children:e.jsxs("div",{className:`text-2xl font-bold ${d.netBalance>=0?"text-green-600":"text-red-600"}`,children:["R$ ",d.netBalance.toFixed(2)]})})]})]}),e.jsxs(le,{defaultValue:"transactions",className:"space-y-4",children:[e.jsxs(ce,{children:[e.jsx(b,{value:"transactions",children:"Lançamentos"}),e.jsx(b,{value:"reports",children:"Relatórios"})]}),e.jsxs(w,{value:"transactions",className:"space-y-4",children:[e.jsxs(i,{children:[e.jsxs(n,{children:[e.jsx(l,{children:"Novo Lançamento"}),e.jsx(u,{children:"Registre uma nova entrada ou saída financeira"})]}),e.jsx(c,{children:e.jsxs("form",{onSubmit:z(Z),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Tipo"}),e.jsxs("select",{...t("type"),className:"w-full p-2 border rounded-md",children:[e.jsx("option",{value:"income",children:"Entrada"}),e.jsx("option",{value:"expense",children:"Saída"})]}),a.type&&e.jsx("span",{className:"text-sm text-red-500",children:a.type.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Data"}),e.jsx("input",{type:"date",...t("date"),className:"w-full p-2 border rounded-md"}),a.date&&e.jsx("span",{className:"text-sm text-red-500",children:a.date.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Valor"}),e.jsx("input",{type:"number",step:"0.01",...t("value",{valueAsNumber:!0}),className:"w-full p-2 border rounded-md"}),a.value&&e.jsx("span",{className:"text-sm text-red-500",children:a.value.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Forma de Pagamento"}),e.jsxs("select",{...t("paymentMethod"),className:"w-full p-2 border rounded-md",children:[e.jsx("option",{value:"",children:"Selecione..."}),ye.map(s=>e.jsx("option",{value:s,children:s},s))]}),a.paymentMethod&&e.jsx("span",{className:"text-sm text-red-500",children:a.paymentMethod.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Categoria"}),e.jsxs("select",{...t("category"),className:"w-full p-2 border rounded-md",children:[e.jsx("option",{value:"",children:"Selecione..."}),W==="income"?E.map(s=>e.jsx("option",{value:s,children:s},s)):L.map(s=>e.jsx("option",{value:s,children:s},s))]}),a.category&&e.jsx("span",{className:"text-sm text-red-500",children:a.category.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Descrição"}),e.jsx("input",{type:"text",...t("description"),className:"w-full p-2 border rounded-md"}),a.description&&e.jsx("span",{className:"text-sm text-red-500",children:a.description.message})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Observações"}),e.jsx("textarea",{...t("notes"),className:"w-full p-2 border rounded-md",rows:3})]}),e.jsx(j,{type:"submit",disabled:g,children:g?"Registrando...":"Registrar Lançamento"})]})})]}),e.jsxs(i,{children:[e.jsxs(n,{children:[e.jsx(l,{children:"Histórico de Lançamentos"}),e.jsx(u,{children:"Visualize e gerencie todos os lançamentos"})]}),e.jsx(c,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Pesquisar lançamentos...",value:J,onChange:s=>Q(s.target.value),className:"w-full p-2 border rounded-md"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:X,onChange:s=>H(s.target.value),className:"p-2 border rounded-md",children:[e.jsx("option",{value:"week",children:"Última Semana"}),e.jsx("option",{value:"month",children:"Último Mês"}),e.jsx("option",{value:"quarter",children:"Último Trimestre"}),e.jsx("option",{value:"year",children:"Último Ano"})]}),e.jsxs("select",{value:Y,onChange:s=>G(s.target.value),className:"p-2 border rounded-md",children:[e.jsx("option",{value:"all",children:"Todas Categorias"}),[...E,...L].map(s=>e.jsx("option",{value:s,children:s},s))]})]})]}),P?e.jsx("div",{className:"flex justify-center items-center py-8",children:e.jsx(he,{className:"h-8 w-8 animate-spin text-gray-400"})}):x.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Nenhum lançamento encontrado"}):e.jsx("div",{className:"space-y-4",children:x.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[s.type==="income"?e.jsx(A,{className:"h-8 w-8 text-green-500"}):e.jsx(k,{className:"h-8 w-8 text-red-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.description}),e.jsxs("div",{className:"text-sm text-gray-500",children:[p(new Date(s.date),"dd/MM/yyyy")," • ",s.category]})]})]}),e.jsxs("div",{className:`text-lg font-bold ${s.type==="income"?"text-green-600":"text-red-600"}`,children:["R$ ",s.value.toFixed(2)]})]},s.id))})]})})]})]}),e.jsx(w,{value:"reports",children:e.jsxs(i,{children:[e.jsxs(n,{children:[e.jsx(l,{children:"Relatórios Financeiros"}),e.jsx(u,{children:"Análise detalhada das movimentações financeiras"})]}),e.jsx(c,{children:e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"h-[300px]",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(je,{data:x,children:[e.jsx(T,{strokeDasharray:"3 3"}),e.jsx(D,{dataKey:"date"}),e.jsx(S,{}),e.jsx(R,{}),e.jsx(F,{}),e.jsx(M,{dataKey:"value",fill:"#4ade80",name:"Receitas"}),e.jsx(M,{dataKey:"value",fill:"#f87171",name:"Despesas"})]})})}),e.jsx("div",{className:"h-[300px]",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(xe,{data:x,children:[e.jsx(T,{strokeDasharray:"3 3"}),e.jsx(D,{dataKey:"date"}),e.jsx(S,{}),e.jsx(R,{}),e.jsx(F,{}),e.jsx(pe,{type:"monotone",dataKey:"value",name:"Fluxo de Caixa",stroke:"#3b82f6"})]})})})]})})]})})]})]})}export{ke as default};
