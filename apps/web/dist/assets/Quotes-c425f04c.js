import{c as w,d as A,j as e,B as i,F as D}from"./index-15ba3699.js";import{u as F}from"./index.esm-853230a7.js";import{o as x,s as d,d as p,n as u,t as V,T as z,a as M,b as h,c as j}from"./tabs-1121ec05.js";import{C as b,b as f,c as g,a as y}from"./card-2f14c19d.js";import{f as $}from"./index-0bd7da91.js";import{T as N}from"./tag-d60cab13.js";import{P as B,T as Q}from"./trash-2-139a187c.js";const R=w("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),E=w("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),G=x({clientId:d().min(1,"Cliente é obrigatório"),description:d().min(3,"Descrição é obrigatória"),items:p(x({productId:d().min(1,"Produto é obrigatório"),description:d(),quantity:u().min(1,"Quantidade deve ser maior que 0"),unitPrice:u().min(0,"Preço deve ser maior ou igual a 0")})).min(1,"Adicione pelo menos um item"),tags:p(d()).optional(),profitPercentage:u().min(0,"Porcentagem de lucro deve ser maior ou igual a 0")}),U=[{id:"1",name:"Cliente A"},{id:"2",name:"Cliente B"}],v=[{id:"1",name:"Produto A",price:100},{id:"2",name:"Produto B",price:200}];function ee(){const{toast:P}=A(),{register:r,control:H,handleSubmit:T,watch:m,setValue:n,formState:{errors:l}}=F({resolver:V(G),defaultValues:{items:[],tags:[],profitPercentage:30,status:"draft",createdAt:$(new Date,"yyyy-MM-dd")}}),c=m("items")||[],C=m("profitPercentage"),k=s=>s.quantity*s.unitPrice,I=()=>c.reduce((t,a)=>t+k(a),0)*(1+C/100),S=()=>{n("items",[...c,{productId:"",description:"",quantity:1,unitPrice:0}])},L=s=>{n("items",c.filter((t,a)=>a!==s))},O=(s,t)=>{const a=v.find(o=>o.id===t);if(a){const o=[...c];o[s]={...o[s],productId:t,unitPrice:a.price},n("items",o)}},q=s=>{console.log(s),P({title:"Orçamento salvo com sucesso!",description:"O orçamento foi salvo como rascunho."})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Orçamentos"}),e.jsx("p",{className:"text-muted-foreground",children:"Gerencie seus orçamentos"})]}),e.jsxs(z,{defaultValue:"new",className:"space-y-4",children:[e.jsxs(M,{children:[e.jsx(h,{value:"new",children:"Criar Orçamento"}),e.jsx(h,{value:"list",children:"Lista de Orçamentos"})]}),e.jsx(j,{value:"new",children:e.jsxs(b,{children:[e.jsx(f,{children:e.jsx(g,{children:"Novo Orçamento"})}),e.jsx(y,{children:e.jsxs("form",{onSubmit:T(q),className:"space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Cliente *"}),e.jsxs("select",{...r("clientId"),className:"w-full rounded-md border p-2",children:[e.jsx("option",{value:"",children:"Selecione um cliente"}),U.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),l.clientId&&e.jsx("span",{className:"text-sm text-red-500",children:l.clientId.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Data"}),e.jsx("input",{type:"date",...r("createdAt"),className:"w-full rounded-md border p-2",disabled:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Descrição *"}),e.jsx("textarea",{...r("description"),className:"w-full rounded-md border p-2",rows:3}),l.description&&e.jsx("span",{className:"text-sm text-red-500",children:l.description.message})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(i,{type:"button",variant:"outline",size:"sm",onClick:()=>{const s=m("tags")||[];n("tags",[...s,"urgente"])},children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),"Urgente"]}),e.jsxs(i,{type:"button",variant:"outline",size:"sm",onClick:()=>{const s=m("tags")||[];n("tags",[...s,"vip"])},children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),"VIP"]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Itens do Orçamento"}),e.jsxs(i,{type:"button",onClick:S,variant:"outline",size:"sm",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Adicionar Item"]})]}),c.map((s,t)=>e.jsxs("div",{className:"grid gap-4 md:grid-cols-5 items-start border rounded-lg p-4",children:[e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Produto/Serviço *"}),e.jsxs("select",{...r(`items.${t}.productId`),className:"w-full rounded-md border p-2",onChange:a=>O(t,a.target.value),children:[e.jsx("option",{value:"",children:"Selecione..."}),v.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Quantidade *"}),e.jsx("input",{type:"number",...r(`items.${t}.quantity`),className:"w-full rounded-md border p-2",min:"1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Valor Unitário *"}),e.jsx("input",{type:"number",...r(`items.${t}.unitPrice`),className:"w-full rounded-md border p-2",step:"0.01"})]}),e.jsx("div",{className:"flex items-end justify-end h-full",children:e.jsx(i,{type:"button",variant:"destructive",size:"icon",onClick:()=>L(t),children:e.jsx(Q,{className:"h-4 w-4"})})})]},t)),l.items&&e.jsx("span",{className:"text-sm text-red-500 block",children:"Adicione pelo menos um item"})]}),e.jsxs("div",{className:"space-y-4 bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Resumo Financeiro"}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Porcentagem de Lucro (%)"}),e.jsx("input",{type:"number",...r("profitPercentage"),className:"w-full rounded-md border p-2",min:"0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Total com Lucro"}),e.jsx("input",{type:"text",value:`R$ ${I().toFixed(2)}`,className:"w-full rounded-md border p-2 bg-gray-100",disabled:!0})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsxs(i,{type:"button",variant:"outline",children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Duplicar"]}),e.jsxs(i,{type:"button",variant:"outline",children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Gerar PDF"]}),e.jsxs(i,{type:"button",variant:"outline",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Link Externo"]}),e.jsx(i,{type:"submit",children:"Salvar Orçamento"})]})]})})]})}),e.jsx(j,{value:"list",children:e.jsxs(b,{children:[e.jsx(f,{children:e.jsx(g,{children:"Lista de Orçamentos"})}),e.jsx(y,{})]})})]})]})}export{ee as default};
