import{j as e,B as u,W as z,d as q,R as m,L as F}from"./index-3e5870c5.js";import{o as O,s as x,n as v,d as R,t as k,T as A,a as B,b as f,c as N}from"./tabs-21993d5d.js";import{D as V,u as h}from"./useApi-5cb55952.js";import{a as p}from"./api-a6c5b2a0.js";import{u as I}from"./index.esm-04cc717d.js";import{C as y,b,c as S,a as C}from"./card-0f409810.js";import{T as M}from"./tag-e9c13a98.js";import{P as U,T as W}from"./trash-2-02c85daf.js";import{P as $,C as G}from"./confirm-dialog-8a944b73.js";const H=O({name:x().min(3,"Nome deve ter no mínimo 3 caracteres"),description:x().optional(),unit:x().min(1,"Unidade é obrigatória"),cost_price:v().min(0,"Preço de custo deve ser maior ou igual a 0"),suggested_price:v().min(0,"Preço sugerido deve ser maior ou igual a 0"),category:x().min(1,"Categoria é obrigatória"),tags:R(x()).optional()}),J=["Instalação","Manutenção","Consultoria","Projeto","Outro"];function K({onSubmit:o}){const{register:t,handleSubmit:l,watch:i,setValue:n,reset:c,formState:{errors:s}}=I({resolver:k(H),defaultValues:{tags:[]}}),d=async a=>{await o(a),c()};return e.jsxs(y,{children:[e.jsx(b,{children:e.jsx(S,{children:"Novo Serviço"})}),e.jsx(C,{children:e.jsxs("form",{onSubmit:l(d),className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Nome *"}),e.jsx("input",{...t("name"),className:"w-full rounded-md border p-2"}),s.name&&e.jsx("span",{className:"text-sm text-red-500",children:s.name.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Categoria *"}),e.jsxs("select",{...t("category"),className:"w-full rounded-md border p-2",children:[e.jsx("option",{value:"",children:"Selecione..."}),J.map(a=>e.jsx("option",{value:a,children:a},a))]}),s.category&&e.jsx("span",{className:"text-sm text-red-500",children:s.category.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Unidade *"}),e.jsx("input",{...t("unit"),className:"w-full rounded-md border p-2",placeholder:"hora, projeto, unidade..."}),s.unit&&e.jsx("span",{className:"text-sm text-red-500",children:s.unit.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Preço de Custo *"}),e.jsx("input",{type:"number",step:"0.01",...t("cost_price",{valueAsNumber:!0}),className:"w-full rounded-md border p-2"}),s.cost_price&&e.jsx("span",{className:"text-sm text-red-500",children:s.cost_price.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Preço Sugerido *"}),e.jsx("input",{type:"number",step:"0.01",...t("suggested_price",{valueAsNumber:!0}),className:"w-full rounded-md border p-2"}),s.suggested_price&&e.jsx("span",{className:"text-sm text-red-500",children:s.suggested_price.message})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Descrição"}),e.jsx("textarea",{...t("description"),className:"w-full rounded-md border p-2",rows:3})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(u,{type:"button",variant:"outline",size:"sm",onClick:()=>{const a=i("tags")||[];n("tags",[...a,"destaque"])},children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Destaque"]}),e.jsxs(u,{type:"button",variant:"outline",size:"sm",onClick:()=>{const a=i("tags")||[];n("tags",[...a,"novo"])},children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Novo"]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(u,{type:"submit",children:"Cadastrar Serviço"})})]})})]})}const Q=["Instalação","Manutenção","Consultoria","Projeto","Outro"];function X({services:o,onDelete:t,searchTerm:l,setSearchTerm:i,selectedCategory:n,setSelectedCategory:c}){return e.jsxs(y,{children:[e.jsx(b,{children:e.jsx(S,{children:"Catálogo de Serviços"})}),e.jsx(C,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsx("div",{children:e.jsx("input",{type:"text",placeholder:"Buscar...",className:"w-full rounded-md border p-2",value:l,onChange:s=>i(s.target.value)})}),e.jsx("div",{children:e.jsxs("select",{className:"w-full rounded-md border p-2",value:n,onChange:s=>c(s.target.value),children:[e.jsx("option",{value:"all",children:"Todas Categorias"}),Q.map(s=>e.jsx("option",{value:s,children:s},s))]})}),e.jsx("div",{children:e.jsxs(u,{className:"w-full",variant:"outline",children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Exportar"]})})]}),e.jsx("div",{className:"space-y-4",children:o.map(s=>e.jsxs("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(z,{className:"h-4 w-4"}),s.name]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.category," • ",s.unit]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"text-sm font-medium",children:["Preço Sugerido: R$ ",s.suggested_price.toFixed(2)]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{variant:"ghost",size:"icon",children:e.jsx($,{className:"h-4 w-4"})}),e.jsx(G,{title:"Excluir Serviço",description:"Tem certeza que deseja excluir este serviço? Esta ação não pode ser desfeita.",variant:"destructive",onConfirm:()=>t(s.id),children:e.jsx(u,{variant:"ghost",size:"icon",children:e.jsx(W,{className:"h-4 w-4"})})})]})]})]}),s.tags&&s.tags.length>0&&e.jsx("div",{className:"mt-2 flex gap-2",children:s.tags.map(d=>e.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-gray-100",children:d},d))})]},s.id))})]})})]})}function oe(){const{toast:o}=q(),[t,l]=m.useState([]),[i,n]=m.useState(""),[c,s]=m.useState("all"),[d,a]=m.useState(!0),{execute:w}=h(p.services.list),{execute:T}=h(p.services.create),{execute:P}=h(p.services.delete),{execute:E}=h(p.services.search);m.useEffect(()=>{j()},[]);const j=async()=>{try{a(!0);const r=await w();l(r)}catch(r){console.error("Error loading services:",r)}finally{a(!1)}},_=async r=>{try{await T(r),o({title:"Serviço cadastrado com sucesso!",description:"O serviço foi adicionado ao catálogo."}),j()}catch(g){console.error("Error creating service:",g)}},D=async r=>{try{await P(r),o({title:"Serviço excluído com sucesso!",description:"O serviço foi removido do catálogo."}),j()}catch(g){console.error("Error deleting service:",g)}},L=async()=>{try{a(!0);const r=await E({term:i,category:c});l(r)}catch(r){console.error("Error searching services:",r)}finally{a(!1)}};return m.useEffect(()=>{const r=setTimeout(L,300);return()=>clearTimeout(r)},[i,c]),d?e.jsx(F,{}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Serviços"}),e.jsx("p",{className:"text-muted-foreground",children:"Gerencie seu catálogo de serviços"})]}),e.jsxs(A,{defaultValue:"register",className:"space-y-4",children:[e.jsxs(B,{children:[e.jsx(f,{value:"register",children:"Cadastrar"}),e.jsx(f,{value:"list",children:"Catálogo"})]}),e.jsx(N,{value:"register",children:e.jsx(K,{onSubmit:_})}),e.jsx(N,{value:"list",children:e.jsx(X,{services:t,onDelete:D,searchTerm:i,setSearchTerm:n,selectedCategory:c,setSelectedCategory:s})})]})]})}export{oe as default};
